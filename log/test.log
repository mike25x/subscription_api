  [1m[36m (249.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (96.3ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (257.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (192.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (106.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.6ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (122.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (149.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (12.6ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (22.5ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (4.9ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:47:55', '2013-12-16 22:47:55', 980190962)[0m
  [1m[35mFixture Insert (0.5ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:47:55', '2013-12-16 22:47:55', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:47:55', '2013-12-16 22:47:55', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:47:55', '2013-12-16 22:47:55', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (88.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:47:55', '2013-12-16 22:47:55', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:47:55', '2013-12-16 22:47:55', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:47:56', '2013-12-16 22:47:56', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:47:56', '2013-12-16 22:47:56', 298486374)[0m
  [1m[35m (95.0ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (109.9ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (151.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (143.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (157.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (108.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (133.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (125.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:48:31', '2013-12-16 22:48:31', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:48:31', '2013-12-16 22:48:31', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:48:31', '2013-12-16 22:48:31', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:48:31', '2013-12-16 22:48:31', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:48:31', '2013-12-16 22:48:31', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:48:31', '2013-12-16 22:48:31', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:48:31', '2013-12-16 22:48:31', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:48:31', '2013-12-16 22:48:31', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#index as HTML
  Rendered text template (0.0ms)
Completed 200 OK in 66ms (Views: 65.2ms | ActiveRecord: 0.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (102.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (81.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (187.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (122.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (136.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:49:06', '2013-12-16 22:49:06', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:49:06', '2013-12-16 22:49:06', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:49:06', '2013-12-16 22:49:06', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:49:06', '2013-12-16 22:49:06', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:49:06', '2013-12-16 22:49:06', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:49:06', '2013-12-16 22:49:06', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:49:06', '2013-12-16 22:49:06', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:49:06', '2013-12-16 22:49:06', 298486374)[0m
  [1m[35m (57.3ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#index as HTML
  Rendered text template (0.0ms)
Completed 200 OK in 94ms (Views: 93.2ms | ActiveRecord: 0.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (154.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (101.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (274.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (122.9ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (129.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:51:51', '2013-12-16 22:51:51', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:51:51', '2013-12-16 22:51:51', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:51:51', '2013-12-16 22:51:51', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:51:51', '2013-12-16 22:51:51', 298486374)[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:51:51', '2013-12-16 22:51:51', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:51:51', '2013-12-16 22:51:51', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:51:51', '2013-12-16 22:51:51', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:51:51', '2013-12-16 22:51:51', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 16:51:51 -0600"}
  [1m[36m (19.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (27.8ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-16 22:51:51', 'tst@tst', '2013-12-16 22:51:51', '2013-12-16 22:51:51')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 108ms (Views: 0.3ms | ActiveRecord: 47.3ms)
  [1m[35m (2.9ms)[0m  ROLLBACK
  [1m[36m (82.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (178.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (190.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (133.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (151.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:53:21', '2013-12-16 22:53:21', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:53:21', '2013-12-16 22:53:21', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:53:21', '2013-12-16 22:53:21', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:53:21', '2013-12-16 22:53:21', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:53:21', '2013-12-16 22:53:21', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:53:21', '2013-12-16 22:53:21', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:53:21', '2013-12-16 22:53:21', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:53:21', '2013-12-16 22:53:21', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"params"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 16:53:21 -0600"}}
Unpermitted parameters: params
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`created_at`, `updated_at`) VALUES ('2013-12-16 22:53:21', '2013-12-16 22:53:21')
  [1m[36m (0.5ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 31ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (72.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (71.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (154.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (122.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (128.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:54:05', '2013-12-16 22:54:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 22:54:05', '2013-12-16 22:54:05', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:54:05', '2013-12-16 22:54:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 22:54:05', '2013-12-16 22:54:05', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:54:05', '2013-12-16 22:54:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 22:54:05', '2013-12-16 22:54:05', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:54:05', '2013-12-16 22:54:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 22:54:05', '2013-12-16 22:54:05', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"params"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 16:54:05 -0600"}}
{"params"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 16:54:05 -0600"}, "controller"=>"api", "action"=>"register_user"}
Unpermitted parameters: params
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`created_at`, `updated_at`) VALUES ('2013-12-16 22:54:05', '2013-12-16 22:54:05')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 29ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (96.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (15.8ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (183.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (259.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (103.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (144.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (122.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (322.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.2ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 23:16:32', '2013-12-16 23:16:32', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 23:16:32', '2013-12-16 23:16:32', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 23:16:32', '2013-12-16 23:16:32', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 23:16:32', '2013-12-16 23:16:32', 298486374)[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 23:16:32', '2013-12-16 23:16:32', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 23:16:32', '2013-12-16 23:16:32', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 23:16:32', '2013-12-16 23:16:32', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 23:16:32', '2013-12-16 23:16:32', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"params"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 17:16:33 -0600"}}
{"params"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 17:16:33 -0600"}, "controller"=>"api", "action"=>"register_user"}
Completed 400 Bad Request in 1ms
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[36m (142.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (195.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (317.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (142.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (135.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (194.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (15.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 23:20:41', '2013-12-16 23:20:41', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 23:20:41', '2013-12-16 23:20:41', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 23:20:41', '2013-12-16 23:20:41', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 23:20:41', '2013-12-16 23:20:41', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 23:20:41', '2013-12-16 23:20:41', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 23:20:41', '2013-12-16 23:20:41', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 23:20:41', '2013-12-16 23:20:41', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 23:20:41', '2013-12-16 23:20:41', 298486374)[0m
  [1m[35m (23.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"params"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 17:20:41 -0600"}}
hola
{"params"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 17:20:41 -0600"}, "controller"=>"api", "action"=>"register_user"}
Completed 400 Bad Request in 1ms
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (49.9ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (349.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (133.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (120.9ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 23:20:56', '2013-12-16 23:20:56', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-16 23:20:56', '2013-12-16 23:20:56', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 23:20:56', '2013-12-16 23:20:56', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-16 23:20:56', '2013-12-16 23:20:56', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 23:20:56', '2013-12-16 23:20:56', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-16 23:20:56', '2013-12-16 23:20:56', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 23:20:56', '2013-12-16 23:20:56', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-16 23:20:56', '2013-12-16 23:20:56', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 17:20:56 -0600"}}
hola
{"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 17:20:56 -0600"}, "controller"=>"api", "action"=>"register_user"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-16 23:20:56', 'tst@tst', '2013-12-16 23:20:56', '2013-12-16 23:20:56')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 62ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (15.7ms)[0m  ROLLBACK
  [1m[36m (810.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (16.1ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (306.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (407.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (305.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (306.6ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (278.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (282.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (14.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (15.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:31:19', '2013-12-17 00:31:19', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:31:19', '2013-12-17 00:31:19', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:31:19', '2013-12-17 00:31:19', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:31:19', '2013-12-17 00:31:19', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:31:19', '2013-12-17 00:31:19', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:31:19', '2013-12-17 00:31:19', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:31:19', '2013-12-17 00:31:19', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:31:19', '2013-12-17 00:31:19', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:31:19 -0600"}}
hola
{"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:31:19 -0600"}, "controller"=>"api", "action"=>"register_user"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:31:19', 'tst@tst', '2013-12-17 00:31:19', '2013-12-17 00:31:19')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 83ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (30.1ms)[0m  ROLLBACK
  [1m[36m (48.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (125.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (237.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (133.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.6ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (136.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:39:54', '2013-12-17 00:39:54', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:39:54', '2013-12-17 00:39:54', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:39:54', '2013-12-17 00:39:54', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:39:54', '2013-12-17 00:39:54', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:39:54', '2013-12-17 00:39:54', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:39:54', '2013-12-17 00:39:54', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:39:54', '2013-12-17 00:39:54', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:39:54', '2013-12-17 00:39:54', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:39:54 -0600"}}
hola
{"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:39:54 -0600"}, "controller"=>"api", "action"=>"register_user"}
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:39:54', 'tst@tst', '2013-12-17 00:39:54', '2013-12-17 00:39:54')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 29ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (98.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (15.8ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (108.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (198.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (219.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (123.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (148.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:40:26', '2013-12-17 00:40:26', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:40:26', '2013-12-17 00:40:26', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:40:26', '2013-12-17 00:40:26', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:40:26', '2013-12-17 00:40:26', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:40:26', '2013-12-17 00:40:26', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:40:26', '2013-12-17 00:40:26', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:40:26', '2013-12-17 00:40:26', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:40:26', '2013-12-17 00:40:26', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:40:26 -0600"}}
hola
{"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:40:26 -0600"}, "controller"=>"api", "action"=>"register_user"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:40:27', 'tst@tst', '2013-12-17 00:40:26', '2013-12-17 00:40:27')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 50ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (15.8ms)[0m  ROLLBACK
  [1m[36m (46.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (117.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (231.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (123.6ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (132.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (125.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:40:58', '2013-12-17 00:40:58', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:40:58', '2013-12-17 00:40:58', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:40:58', '2013-12-17 00:40:58', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:40:58', '2013-12-17 00:40:58', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:40:58', '2013-12-17 00:40:58', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:40:58', '2013-12-17 00:40:58', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:40:58', '2013-12-17 00:40:58', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:40:58', '2013-12-17 00:40:58', 298486374)[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:40:58 -0600"}}
hola
{"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:40:58 -0600"}, "controller"=>"api", "action"=>"register_user"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:40:58', 'tst@tst', '2013-12-17 00:40:58', '2013-12-17 00:40:58')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 29ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (62.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (96.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (249.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (133.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (143.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (159.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.2ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:42:08', '2013-12-17 00:42:08', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:42:08', '2013-12-17 00:42:08', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:42:08', '2013-12-17 00:42:08', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:42:08', '2013-12-17 00:42:08', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:42:08', '2013-12-17 00:42:08', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:42:08', '2013-12-17 00:42:08', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:42:08', '2013-12-17 00:42:08', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:42:08', '2013-12-17 00:42:08', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:42:08 -0600"}}
hola
{"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:42:08 -0600"}, "controller"=>"api", "action"=>"register_user"}
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:42:08', 'tst@tst', '2013-12-17 00:42:08', '2013-12-17 00:42:08')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 27ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (35.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (73.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (176.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (144.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:42:57', '2013-12-17 00:42:57', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:42:57', '2013-12-17 00:42:57', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:42:57', '2013-12-17 00:42:57', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:42:57', '2013-12-17 00:42:57', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:42:57', '2013-12-17 00:42:57', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:42:57', '2013-12-17 00:42:57', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:42:57', '2013-12-17 00:42:57', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:42:57', '2013-12-17 00:42:57', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#index as HTML
  Rendered text template (0.0ms)
Completed 200 OK in 40ms (Views: 40.0ms | ActiveRecord: 0.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (69.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (94.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (208.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (132.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (136.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:43:17', '2013-12-17 00:43:17', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:43:17', '2013-12-17 00:43:17', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:43:17', '2013-12-17 00:43:17', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:43:17', '2013-12-17 00:43:17', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:43:17', '2013-12-17 00:43:17', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:43:17', '2013-12-17 00:43:17', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:43:17', '2013-12-17 00:43:17', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:43:17', '2013-12-17 00:43:17', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#index as HTML
index
  Rendered text template (0.0ms)
Completed 200 OK in 5ms (Views: 4.1ms | ActiveRecord: 0.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (105.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (103.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (209.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (135.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (161.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:43:26', '2013-12-17 00:43:26', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:43:26', '2013-12-17 00:43:26', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:43:26', '2013-12-17 00:43:26', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:43:26', '2013-12-17 00:43:26', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:43:26', '2013-12-17 00:43:26', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:43:26', '2013-12-17 00:43:26', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:43:26', '2013-12-17 00:43:26', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:43:26', '2013-12-17 00:43:26', 298486374)[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#index as HTML
index
  Rendered text template (0.0ms)
Completed 200 OK in 5ms (Views: 4.3ms | ActiveRecord: 0.0ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (70.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (93.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (209.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (143.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (177.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (204.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.5ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:43:33', '2013-12-17 00:43:33', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:43:33', '2013-12-17 00:43:33', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:43:33', '2013-12-17 00:43:33', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:43:33', '2013-12-17 00:43:33', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:43:33', '2013-12-17 00:43:33', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:43:33', '2013-12-17 00:43:33', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:43:33', '2013-12-17 00:43:33', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:43:33', '2013-12-17 00:43:33', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#index as HTML
index
  Rendered text template (0.0ms)
Completed 200 OK in 5ms (Views: 4.4ms | ActiveRecord: 0.0ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36m (41.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (111.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (243.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (133.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (110.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (114.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:44:08', '2013-12-17 00:44:08', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:44:08', '2013-12-17 00:44:08', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:44:08', '2013-12-17 00:44:08', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:44:08', '2013-12-17 00:44:08', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:44:08', '2013-12-17 00:44:08', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:44:08', '2013-12-17 00:44:08', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:44:08', '2013-12-17 00:44:08', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:44:08', '2013-12-17 00:44:08', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:44:08 -0600"}}
hola
{"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:44:08 -0600"}, "controller"=>"api", "action"=>"register_user"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:44:08', 'tst@tst', '2013-12-17 00:44:08', '2013-12-17 00:44:08')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 29ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (1.2ms)[0m  ROLLBACK
  [1m[36m (204.6ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (199.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (187.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (177.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (179.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:45:05', '2013-12-17 00:45:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:45:05', '2013-12-17 00:45:05', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:45:05', '2013-12-17 00:45:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:45:05', '2013-12-17 00:45:05', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:45:05', '2013-12-17 00:45:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:45:05', '2013-12-17 00:45:05', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:45:05', '2013-12-17 00:45:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:45:05', '2013-12-17 00:45:05', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:45:05 -0600"}}
hola
{"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:45:05 -0600"}, "controller"=>"api", "action"=>"register_user"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:45:05', 'tst@tst', '2013-12-17 00:45:05', '2013-12-17 00:45:05')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 32ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (43.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (154.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (255.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (142.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (167.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (164.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (126.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.4ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:45:36', '2013-12-17 00:45:36', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:45:36', '2013-12-17 00:45:36', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:45:36', '2013-12-17 00:45:36', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:45:36', '2013-12-17 00:45:36', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:45:36', '2013-12-17 00:45:36', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:45:36', '2013-12-17 00:45:36', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:45:36', '2013-12-17 00:45:36', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:45:36', '2013-12-17 00:45:36', 298486374)[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:45:36 -0600"}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:45:36', 'tst@tst', '2013-12-17 00:45:36', '2013-12-17 00:45:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 32ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (71.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (67.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (143.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (291.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (289.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (143.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:46:15', '2013-12-17 00:46:15', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:46:15', '2013-12-17 00:46:15', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:46:15', '2013-12-17 00:46:15', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:46:15', '2013-12-17 00:46:15', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:46:15', '2013-12-17 00:46:15', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:46:15', '2013-12-17 00:46:15', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:46:15', '2013-12-17 00:46:15', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:46:15', '2013-12-17 00:46:15', 298486374)[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:46:15 -0600"}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 00:46:15', 'tst@tst', '2013-12-17 00:46:15', '2013-12-17 00:46:15')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 31ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (16.0ms)[0m  ROLLBACK
  [1m[36m (39.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (119.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (220.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (134.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:48:21', '2013-12-17 00:48:21', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 00:48:21', '2013-12-17 00:48:21', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:48:21', '2013-12-17 00:48:21', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 00:48:21', '2013-12-17 00:48:21', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:48:21', '2013-12-17 00:48:21', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 00:48:21', '2013-12-17 00:48:21', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:48:21', '2013-12-17 00:48:21', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 00:48:21', '2013-12-17 00:48:21', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-16 18:48:21 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 00:48:21', 'tst@tst', '2013-12-17 00:48:21')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 28ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (262.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (25.2ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (256.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (241.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (143.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (155.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (204.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (24.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (9.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (15.8ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:14:52', '2013-12-17 17:14:52', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:14:52', '2013-12-17 17:14:52', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:14:52', '2013-12-17 17:14:52', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:14:52', '2013-12-17 17:14:52', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (23.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:14:52', '2013-12-17 17:14:52', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:14:52', '2013-12-17 17:14:52', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:14:52', '2013-12-17 17:14:52', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:14:52', '2013-12-17 17:14:52', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:14:52 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:14:53', 'tst@tst', '2013-12-17 17:14:53')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 66ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35m (21.8ms)[0m  ROLLBACK
  [1m[36m (24.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (105.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (209.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (139.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:15:41', '2013-12-17 17:15:41', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:15:41', '2013-12-17 17:15:41', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:15:41', '2013-12-17 17:15:41', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:15:41', '2013-12-17 17:15:41', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:15:41', '2013-12-17 17:15:41', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:15:41', '2013-12-17 17:15:41', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:15:41', '2013-12-17 17:15:41', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:15:41', '2013-12-17 17:15:41', 298486374)[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:15:41 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:15:41', 'tst@tst', '2013-12-17 17:15:41')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 28ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (65.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (77.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (198.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (143.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:16:58', '2013-12-17 17:16:58', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:16:58', '2013-12-17 17:16:58', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:16:58', '2013-12-17 17:16:58', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:16:58', '2013-12-17 17:16:58', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:16:58', '2013-12-17 17:16:58', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:16:58', '2013-12-17 17:16:58', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:16:58', '2013-12-17 17:16:58', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:16:58', '2013-12-17 17:16:58', 298486374)[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:16:58 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:16:58', 'tst@tst', '2013-12-17 17:16:58')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 26ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (165.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (15.8ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (206.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (174.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (144.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (122.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (125.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:40:54', '2013-12-17 17:40:54', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:40:54', '2013-12-17 17:40:54', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:40:54', '2013-12-17 17:40:54', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:40:54', '2013-12-17 17:40:54', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:40:54', '2013-12-17 17:40:54', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:40:54', '2013-12-17 17:40:54', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:40:54', '2013-12-17 17:40:54', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:40:54', '2013-12-17 17:40:54', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:40:54 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:40:54', 'tst@tst', '2013-12-17 17:40:54')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 27ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (121.6ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (55.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (176.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:42:56', '2013-12-17 17:42:56', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:42:56', '2013-12-17 17:42:56', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:42:56', '2013-12-17 17:42:56', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:42:56', '2013-12-17 17:42:56', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:42:56', '2013-12-17 17:42:56', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:42:56', '2013-12-17 17:42:56', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:42:56', '2013-12-17 17:42:56', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:42:56', '2013-12-17 17:42:56', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
Completed 400 Bad Request in 0ms
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (37.9ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (50.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (175.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.6ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (165.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:45:11', '2013-12-17 17:45:11', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:45:11', '2013-12-17 17:45:11', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:45:11', '2013-12-17 17:45:11', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:45:11', '2013-12-17 17:45:11', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:45:11', '2013-12-17 17:45:11', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:45:11', '2013-12-17 17:45:11', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:45:11', '2013-12-17 17:45:11', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:45:11', '2013-12-17 17:45:11', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"id"=>nil, "app_id"=>"1", "email"=>"tst@tst", "password_hash"=>"[FILTERED]", "password_salt"=>"[FILTERED]", "last_login"=>"2013-12-17 17:45:11 UTC", "created_at"=>nil, "updated_at"=>nil, "confirmation_hash"=>nil, "activate"=>nil}
Completed 400 Bad Request in 0ms
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (68.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (66.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (209.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (140.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (113.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (126.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.2ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:45:32', '2013-12-17 17:45:32', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:45:32', '2013-12-17 17:45:32', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:45:32', '2013-12-17 17:45:32', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:45:32', '2013-12-17 17:45:32', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:45:32', '2013-12-17 17:45:32', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:45:32', '2013-12-17 17:45:32', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:45:32', '2013-12-17 17:45:32', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:45:32', '2013-12-17 17:45:32', 298486374)[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:45:32 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:45:32', 'tst@tst', '2013-12-17 17:45:32')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 44ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (15.8ms)[0m  ROLLBACK
  [1m[36m (11.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (145.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (188.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (109.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:45:55', '2013-12-17 17:45:55', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:45:55', '2013-12-17 17:45:55', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:45:55', '2013-12-17 17:45:55', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:45:55', '2013-12-17 17:45:55', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:45:55', '2013-12-17 17:45:55', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:45:55', '2013-12-17 17:45:55', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:45:55', '2013-12-17 17:45:55', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:45:55', '2013-12-17 17:45:55', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:45:55 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:45:55', 'tst@tst', '2013-12-17 17:45:55')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 32ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (15.8ms)[0m  ROLLBACK
  [1m[36m (8.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (82.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (123.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (115.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:46:17', '2013-12-17 17:46:17', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:46:17', '2013-12-17 17:46:17', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:46:17', '2013-12-17 17:46:17', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:46:17', '2013-12-17 17:46:17', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:46:17', '2013-12-17 17:46:17', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:46:17', '2013-12-17 17:46:17', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:46:17', '2013-12-17 17:46:17', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:46:17', '2013-12-17 17:46:17', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:46:17 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:46:17', 'tst@tst', '2013-12-17 17:46:17')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 31ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (58.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (67.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (231.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (133.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (126.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:46:34', '2013-12-17 17:46:34', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:46:34', '2013-12-17 17:46:34', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:46:34', '2013-12-17 17:46:34', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:46:34', '2013-12-17 17:46:34', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:46:34', '2013-12-17 17:46:34', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:46:34', '2013-12-17 17:46:34', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:46:34', '2013-12-17 17:46:34', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:46:34', '2013-12-17 17:46:34', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:46:34 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:46:34', 'tst@tst', '2013-12-17 17:46:34')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 33ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (34.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.8ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (79.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (176.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.9ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (127.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:50:00', '2013-12-17 17:50:00', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:50:00', '2013-12-17 17:50:00', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:50:00', '2013-12-17 17:50:00', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:50:00', '2013-12-17 17:50:00', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:50:00', '2013-12-17 17:50:00', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:50:00', '2013-12-17 17:50:00', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:50:00', '2013-12-17 17:50:00', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:50:00', '2013-12-17 17:50:00', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:50:00 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 17:50:00', 'tst@tst', '2013-12-17 17:50:00')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 45ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35m (14.9ms)[0m  ROLLBACK
  [1m[36m (68.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (88.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (164.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (129.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:50:37', '2013-12-17 17:50:37', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:50:37', '2013-12-17 17:50:37', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:50:37', '2013-12-17 17:50:37', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:50:37', '2013-12-17 17:50:37', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:50:37', '2013-12-17 17:50:37', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:50:37', '2013-12-17 17:50:37', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:50:37', '2013-12-17 17:50:37', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:50:37', '2013-12-17 17:50:37', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:50:37 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 17:50:37', 'tst@tst', '2013-12-17 17:50:37')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 31ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (40.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (69.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (227.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (143.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:52:23', '2013-12-17 17:52:23', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 17:52:23', '2013-12-17 17:52:23', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:52:23', '2013-12-17 17:52:23', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 17:52:23', '2013-12-17 17:52:23', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:52:23', '2013-12-17 17:52:23', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 17:52:23', '2013-12-17 17:52:23', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:52:23', '2013-12-17 17:52:23', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 17:52:23', '2013-12-17 17:52:23', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 11:52:23 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 17:52:23', 'tst@tst', '2013-12-17 17:52:23')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 56ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (69.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (180.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (188.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (123.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (159.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (15.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:04:37', '2013-12-17 18:04:37', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:04:37', '2013-12-17 18:04:37', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:04:37', '2013-12-17 18:04:37', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:04:37', '2013-12-17 18:04:37', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:04:37', '2013-12-17 18:04:37', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:04:37', '2013-12-17 18:04:37', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:04:37', '2013-12-17 18:04:37', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:04:37', '2013-12-17 18:04:37', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:04:37 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:04:37', 'tst@tst', '2013-12-17 18:04:37')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (15.7ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (63.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (98.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (185.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (367.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (120.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:09:05', '2013-12-17 18:09:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:09:05', '2013-12-17 18:09:05', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:09:05', '2013-12-17 18:09:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:09:05', '2013-12-17 18:09:05', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:09:05', '2013-12-17 18:09:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:09:05', '2013-12-17 18:09:05', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:09:05', '2013-12-17 18:09:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:09:05', '2013-12-17 18:09:05', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:09:05 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:09:05', 'tst@tst', '2013-12-17 18:09:05')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 34ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst'
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36m (25.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (128.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (209.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (132.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.2ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:09:38', '2013-12-17 18:09:38', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:09:38', '2013-12-17 18:09:38', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:09:39', '2013-12-17 18:09:39', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:09:39', '2013-12-17 18:09:39', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:09:39', '2013-12-17 18:09:39', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:09:39', '2013-12-17 18:09:39', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:09:39', '2013-12-17 18:09:39', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:09:39', '2013-12-17 18:09:39', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:09:39 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:09:39', 'tst@tst', '2013-12-17 18:09:39')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 33ms (Views: 0.4ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users`
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36m (12.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (143.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (133.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:10:10', '2013-12-17 18:10:10', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:10:10', '2013-12-17 18:10:10', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:10:10', '2013-12-17 18:10:10', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:10:10', '2013-12-17 18:10:10', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:10:10', '2013-12-17 18:10:10', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:10:10', '2013-12-17 18:10:10', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:10:10', '2013-12-17 18:10:10', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:10:10', '2013-12-17 18:10:10', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:10:10 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:10:11', 'tst@tst', '2013-12-17 18:10:11')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 28ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users`
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (42.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (99.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (221.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (127.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:12:27', '2013-12-17 18:12:27', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:12:27', '2013-12-17 18:12:27', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:12:27', '2013-12-17 18:12:27', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:12:27', '2013-12-17 18:12:27', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:12:27', '2013-12-17 18:12:27', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:12:27', '2013-12-17 18:12:27', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:12:27', '2013-12-17 18:12:27', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:12:27', '2013-12-17 18:12:27', 298486374)[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>nil}
Completed 400 Bad Request in 1ms
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[36m (48.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (116.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (143.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (150.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:12:39', '2013-12-17 18:12:39', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:12:39', '2013-12-17 18:12:39', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:12:39', '2013-12-17 18:12:39', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:12:39', '2013-12-17 18:12:39', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:12:39', '2013-12-17 18:12:39', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:12:39', '2013-12-17 18:12:39', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:12:39', '2013-12-17 18:12:39', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:12:39', '2013-12-17 18:12:39', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"id"=>nil, "app_id"=>"1", "email"=>"tst@tst", "password_hash"=>"[FILTERED]", "password_salt"=>"[FILTERED]", "last_login"=>"2013-12-17 18:12:39 UTC", "created_at"=>nil, "updated_at"=>nil, "confirmation_hash"=>nil, "activate"=>nil}}
Unpermitted parameters: id, app_id, password_hash, password_salt, last_login, created_at, updated_at, confirmation_hash, activate
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:12:39', 'tst@tst', '2013-12-17 18:12:39')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (74.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (114.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (198.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (139.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:12:52', '2013-12-17 18:12:52', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:12:52', '2013-12-17 18:12:52', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:12:52', '2013-12-17 18:12:52', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:12:52', '2013-12-17 18:12:52', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:12:52', '2013-12-17 18:12:52', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:12:52', '2013-12-17 18:12:52', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:12:52', '2013-12-17 18:12:52', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:12:52', '2013-12-17 18:12:52', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36m (81.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (208.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:13:05', '2013-12-17 18:13:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:13:05', '2013-12-17 18:13:05', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:13:05', '2013-12-17 18:13:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:13:05', '2013-12-17 18:13:05', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:13:05', '2013-12-17 18:13:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:13:05', '2013-12-17 18:13:05', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:13:05', '2013-12-17 18:13:05', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:13:05', '2013-12-17 18:13:05', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"id"=>nil, "app_id"=>"1", "email"=>"tst@tst", "password_hash"=>"[FILTERED]", "password_salt"=>"[FILTERED]", "last_login"=>"2013-12-17 18:13:05 UTC", "created_at"=>nil, "updated_at"=>nil, "confirmation_hash"=>nil, "activate"=>nil}}
Unpermitted parameters: id, app_id, password_hash, password_salt, last_login, created_at, updated_at, confirmation_hash, activate
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:13:05', 'tst@tst', '2013-12-17 18:13:05')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (74.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (248.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (133.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (147.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:15:43', '2013-12-17 18:15:43', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:15:43', '2013-12-17 18:15:43', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:15:43', '2013-12-17 18:15:43', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:15:43', '2013-12-17 18:15:43', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:15:43', '2013-12-17 18:15:43', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:15:43', '2013-12-17 18:15:43', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:15:43', '2013-12-17 18:15:43', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:15:43', '2013-12-17 18:15:43', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"id"=>nil, "app_id"=>"1", "email"=>"tst@tst", "password_hash"=>"[FILTERED]", "password_salt"=>"[FILTERED]", "last_login"=>"2013-12-17 18:15:43 UTC", "created_at"=>nil, "updated_at"=>nil, "confirmation_hash"=>nil, "activate"=>nil}}
Unpermitted parameters: id, app_id, password_hash, password_salt, last_login, created_at, updated_at, confirmation_hash, activate
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:15:43', 'tst@tst', '2013-12-17 18:15:43')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 0.5ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (65.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (89.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (318.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (127.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:16:04', '2013-12-17 18:16:04', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:16:04', '2013-12-17 18:16:04', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:16:04', '2013-12-17 18:16:04', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:16:04', '2013-12-17 18:16:04', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:16:04', '2013-12-17 18:16:04', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:16:04', '2013-12-17 18:16:04', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:16:04', '2013-12-17 18:16:04', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:16:04', '2013-12-17 18:16:04', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"id"=>nil, "app_id"=>"1", "email"=>"tst@tst", "password_hash"=>"[FILTERED]", "password_salt"=>"[FILTERED]", "last_login"=>"2013-12-17 18:16:04 UTC", "created_at"=>nil, "updated_at"=>nil, "confirmation_hash"=>nil, "activate"=>nil}}
Unpermitted parameters: id, app_id, password_hash, password_salt, last_login, created_at, updated_at, confirmation_hash, activate
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:16:04', 'tst@tst', '2013-12-17 18:16:04')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (261.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (13.1ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (189.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (356.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (418.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (271.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (270.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (472.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (53.8ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (34.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (12.4ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (20.8ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:18:01', '2013-12-17 18:18:01', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:18:01', '2013-12-17 18:18:01', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:18:01', '2013-12-17 18:18:01', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:18:01', '2013-12-17 18:18:01', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:18:01', '2013-12-17 18:18:01', 980190962)[0m
  [1m[35mFixture Insert (0.5ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:18:01', '2013-12-17 18:18:01', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:18:01', '2013-12-17 18:18:01', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:18:01', '2013-12-17 18:18:01', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"id"=>nil, "app_id"=>"1", "email"=>"tst@tst", "password_hash"=>"[FILTERED]", "password_salt"=>"[FILTERED]", "last_login"=>"2013-12-17 18:18:01 UTC", "created_at"=>nil, "updated_at"=>nil, "confirmation_hash"=>nil, "activate"=>nil}}
Unpermitted parameters: id, app_id, password_hash, password_salt, last_login, created_at, updated_at, confirmation_hash, activate
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (17.6ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:18:01', 'tst@tst', '2013-12-17 18:18:01')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 53ms (Views: 0.3ms | ActiveRecord: 17.9ms)
  [1m[35m (14.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (196.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (109.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (296.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (123.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (188.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (16.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.9ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:19:09', '2013-12-17 18:19:09', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:19:09', '2013-12-17 18:19:09', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:19:09', '2013-12-17 18:19:09', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:19:09', '2013-12-17 18:19:09', 298486374)[0m
  [1m[35mFixture Delete (0.6ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:19:09', '2013-12-17 18:19:09', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:19:09', '2013-12-17 18:19:09', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:19:09', '2013-12-17 18:19:09', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:19:09', '2013-12-17 18:19:09', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:19:09 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:19:09', 'tst@tst', '2013-12-17 18:19:09')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 23ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (15.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (48.6ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (80.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (250.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (138.4ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (199.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (14.8ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:19:50', '2013-12-17 18:19:50', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:19:50', '2013-12-17 18:19:50', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:19:50', '2013-12-17 18:19:50', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:19:50', '2013-12-17 18:19:50', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:19:50', '2013-12-17 18:19:50', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:19:50', '2013-12-17 18:19:50', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:19:50', '2013-12-17 18:19:50', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:19:50', '2013-12-17 18:19:50', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:19:50 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:19:50', 'tst@tst', '2013-12-17 18:19:50')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (14.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36m (45.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (78.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (307.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (167.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (163.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (159.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:20:06', '2013-12-17 18:20:06', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:20:06', '2013-12-17 18:20:06', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:20:06', '2013-12-17 18:20:06', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:20:06', '2013-12-17 18:20:06', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:20:06', '2013-12-17 18:20:06', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:20:06', '2013-12-17 18:20:06', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:20:06', '2013-12-17 18:20:06', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:20:06', '2013-12-17 18:20:06', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:20:06 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:20:06', 'tst@tst', '2013-12-17 18:20:06')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (330.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (14.8ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (224.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (209.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (129.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (197.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (222.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (14.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (26.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:51:13', '2013-12-17 18:51:13', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:51:13', '2013-12-17 18:51:13', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:51:13', '2013-12-17 18:51:13', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:51:13', '2013-12-17 18:51:13', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:51:13', '2013-12-17 18:51:13', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:51:13', '2013-12-17 18:51:13', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:51:13', '2013-12-17 18:51:13', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:51:13', '2013-12-17 18:51:13', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:51:13 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:51:13', 'tst@tst', '2013-12-17 18:51:13')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 40ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (32.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (12.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (108.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (295.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (97.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.2ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:51:51', '2013-12-17 18:51:51', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:51:51', '2013-12-17 18:51:51', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:51:51', '2013-12-17 18:51:51', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:51:51', '2013-12-17 18:51:51', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:51:51', '2013-12-17 18:51:51', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:51:51', '2013-12-17 18:51:51', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:51:51', '2013-12-17 18:51:51', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:51:51', '2013-12-17 18:51:51', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:51:51 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:51:51', 'tst@tst', '2013-12-17 18:51:51')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[36m (47.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (103.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (297.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (110.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (126.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:52:36', '2013-12-17 18:52:36', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:52:36', '2013-12-17 18:52:36', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:52:36', '2013-12-17 18:52:36', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:52:36', '2013-12-17 18:52:36', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:52:36', '2013-12-17 18:52:36', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:52:36', '2013-12-17 18:52:36', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:52:36', '2013-12-17 18:52:36', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:52:36', '2013-12-17 18:52:36', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:52:36 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:52:36', 'tst@tst', '2013-12-17 18:52:36')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (67.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (14.9ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (76.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (198.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (123.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (124.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:53:30', '2013-12-17 18:53:30', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:53:30', '2013-12-17 18:53:30', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:53:30', '2013-12-17 18:53:30', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:53:30', '2013-12-17 18:53:30', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:53:30', '2013-12-17 18:53:30', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:53:30', '2013-12-17 18:53:30', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:53:30', '2013-12-17 18:53:30', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:53:30', '2013-12-17 18:53:30', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:53:30 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:53:30', 'tst@tst', '2013-12-17 18:53:30')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 33ms (Views: 0.3ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (15.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 18:53:30', 'tst@tst.com', '2013-12-17 18:53:29', '2013-12-17 18:53:30')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"tst@tst.com", "app_id"=>"980190964"}
Completed 500 Internal Server Error in 1ms
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (78.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (84.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (252.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (209.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (352.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:54:02', '2013-12-17 18:54:02', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:54:02', '2013-12-17 18:54:02', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:54:02', '2013-12-17 18:54:02', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:54:02', '2013-12-17 18:54:02', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:54:02', '2013-12-17 18:54:02', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:54:02', '2013-12-17 18:54:02', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:54:02', '2013-12-17 18:54:02', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:54:02', '2013-12-17 18:54:02', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:54:02 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:54:02', 'tst@tst', '2013-12-17 18:54:02')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 18:54:02', 'tst@tst.com', '2013-12-17 18:54:00', '2013-12-17 18:54:02')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"tst@tst.com", "app_id"=>"980190964"}
  [1m[35mUser Load (26.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst.com' AND `users`.`app_id` = 980190964
Completed 500 Internal Server Error in 28ms
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (73.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (107.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (294.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (145.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (287.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (256.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (181.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.4ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:54:22', '2013-12-17 18:54:22', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:54:22', '2013-12-17 18:54:22', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:54:22', '2013-12-17 18:54:22', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:54:22', '2013-12-17 18:54:22', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:54:22', '2013-12-17 18:54:22', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:54:22', '2013-12-17 18:54:22', 298486374)
  [1m[36mFixture Delete (0.8ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.5ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:54:22', '2013-12-17 18:54:22', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:54:22', '2013-12-17 18:54:22', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:54:22 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:54:22', 'tst@tst', '2013-12-17 18:54:22')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 18:54:22', 'tst@tst.com', '2013-12-17 18:54:20', '2013-12-17 18:54:22')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"tst@tst.com", "app_id"=>"980190964"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst.com' AND `users`.`app_id` = 980190964
Completed 500 Internal Server Error in 2ms
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (36.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (97.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (252.8ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (186.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (185.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:54:43', '2013-12-17 18:54:43', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:54:43', '2013-12-17 18:54:43', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:54:43', '2013-12-17 18:54:43', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:54:43', '2013-12-17 18:54:43', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:54:43', '2013-12-17 18:54:43', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:54:43', '2013-12-17 18:54:43', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:54:43', '2013-12-17 18:54:43', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:54:43', '2013-12-17 18:54:43', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:54:43 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:54:43', 'tst@tst', '2013-12-17 18:54:43')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 18:54:43', 'tst@tst.com', '2013-12-17 18:54:42', '2013-12-17 18:54:43')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"tst@tst.com", "app_id"=>"980190964"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst.com' AND `users`.`app_id` = 980190964 LIMIT 1
Completed 500 Internal Server Error in 1ms
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (72.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (190.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (106.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (115.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:55:04', '2013-12-17 18:55:04', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:55:04', '2013-12-17 18:55:04', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:55:04', '2013-12-17 18:55:04', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:55:04', '2013-12-17 18:55:04', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:55:04', '2013-12-17 18:55:04', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:55:04', '2013-12-17 18:55:04', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:55:04', '2013-12-17 18:55:04', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:55:04', '2013-12-17 18:55:04', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:55:04 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:55:04', 'tst@tst', '2013-12-17 18:55:04')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.5ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.8ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 18:55:04', 'tst@tst.com', '2013-12-17 18:55:03', '2013-12-17 18:55:04')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"tst@tst.com", "app_id"=>"980190964"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst.com' AND `users`.`app_id` = 980190964 ORDER BY `users`.`id` ASC LIMIT 1
Completed 500 Internal Server Error in 2ms
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (68.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (107.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (360.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (376.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (117.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:55:28', '2013-12-17 18:55:28', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:55:28', '2013-12-17 18:55:28', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:55:28', '2013-12-17 18:55:28', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:55:28', '2013-12-17 18:55:28', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:55:28', '2013-12-17 18:55:28', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:55:28', '2013-12-17 18:55:28', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:55:28', '2013-12-17 18:55:28', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:55:28', '2013-12-17 18:55:28', 298486374)[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:55:28 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:55:28', 'tst@tst', '2013-12-17 18:55:28')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 18:55:28', 'woop@tst.com', '2013-12-17 18:55:27', '2013-12-17 18:55:28')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"980190964"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 980190964 ORDER BY `users`.`id` ASC LIMIT 1
Completed 500 Internal Server Error in 2ms
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (43.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (179.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (212.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (125.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (131.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (109.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (161.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:57:08', '2013-12-17 18:57:08', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 18:57:08', '2013-12-17 18:57:08', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:57:08', '2013-12-17 18:57:08', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 18:57:08', '2013-12-17 18:57:08', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:57:08', '2013-12-17 18:57:08', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 18:57:08', '2013-12-17 18:57:08', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:57:08', '2013-12-17 18:57:08', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 18:57:08', '2013-12-17 18:57:08', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 12:57:08 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 18:57:08', 'tst@tst', '2013-12-17 18:57:08')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 18:57:08', 'woop@tst.com', '2013-12-17 18:57:07', '2013-12-17 18:57:08')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"980190964"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 980190964 ORDER BY `users`.`id` ASC LIMIT 1
Completed 500 Internal Server Error in 2ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (66.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[36m (71.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (62.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (153.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (185.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (113.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (139.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:00:36', '2013-12-17 19:00:36', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:00:36', '2013-12-17 19:00:36', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:00:36', '2013-12-17 19:00:36', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:00:36', '2013-12-17 19:00:36', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:00:36', '2013-12-17 19:00:36', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:00:36', '2013-12-17 19:00:36', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:00:36', '2013-12-17 19:00:36', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:00:36', '2013-12-17 19:00:36', 298486374)[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:00:36 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:00:36', 'tst@tst', '2013-12-17 19:00:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:00:36', 'woop@tst.com', '2013-12-17 19:00:35', '2013-12-17 19:00:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"980190964"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 980190964 ORDER BY `users`.`id` ASC LIMIT 1[0m
Completed 500 Internal Server Error in 2ms
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (37.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (99.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (229.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (110.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (150.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:04:09', '2013-12-17 19:04:09', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:04:09', '2013-12-17 19:04:09', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:04:09', '2013-12-17 19:04:09', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:04:09', '2013-12-17 19:04:09', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:04:09', '2013-12-17 19:04:09', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:04:09', '2013-12-17 19:04:09', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:04:09', '2013-12-17 19:04:09', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:04:09', '2013-12-17 19:04:09', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:04:09 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:04:09', 'tst@tst', '2013-12-17 19:04:09')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:04:09', 'woop@tst.com', '2013-12-17 19:04:08', '2013-12-17 19:04:09')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"980190964"}
Completed 200 OK in 0ms (Views: 0.2ms | ActiveRecord: 0.0ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (74.6ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (85.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (198.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (107.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (163.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:05:03', '2013-12-17 19:05:03', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:05:03', '2013-12-17 19:05:03', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:05:03', '2013-12-17 19:05:03', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:05:03', '2013-12-17 19:05:03', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:05:03', '2013-12-17 19:05:03', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:05:03', '2013-12-17 19:05:03', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:05:03', '2013-12-17 19:05:03', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:05:03', '2013-12-17 19:05:03', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (44.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (105.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (209.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (118.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (149.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:05:16', '2013-12-17 19:05:16', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:05:16', '2013-12-17 19:05:16', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:05:16', '2013-12-17 19:05:16', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:05:16', '2013-12-17 19:05:16', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:05:16', '2013-12-17 19:05:16', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:05:16', '2013-12-17 19:05:16', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:05:16', '2013-12-17 19:05:16', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:05:16', '2013-12-17 19:05:16', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:05:16 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:05:16', 'tst@tst', '2013-12-17 19:05:16')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:05:16', 'woop@tst.com', '2013-12-17 19:05:15', '2013-12-17 19:05:16')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"980190964"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com'[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (90.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (135.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (251.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (133.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (108.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (117.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.2ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:06:03', '2013-12-17 19:06:03', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:06:03', '2013-12-17 19:06:03', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:06:03', '2013-12-17 19:06:03', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:06:03', '2013-12-17 19:06:03', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:06:03', '2013-12-17 19:06:03', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:06:03', '2013-12-17 19:06:03', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:06:03', '2013-12-17 19:06:03', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:06:03', '2013-12-17 19:06:03', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:06:03 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:06:03', 'tst@tst', '2013-12-17 19:06:03')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:06:03', 'woop@tst.com', '2013-12-17 19:06:02', '2013-12-17 19:06:03')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"980190964"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 980190964[0m
Completed 200 OK in 2ms (Views: 0.3ms | ActiveRecord: 0.4ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (63.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (99.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (232.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.4ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (107.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (127.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:06:23', '2013-12-17 19:06:23', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:06:23', '2013-12-17 19:06:23', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:06:23', '2013-12-17 19:06:23', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:06:23', '2013-12-17 19:06:23', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:06:23', '2013-12-17 19:06:23', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:06:23', '2013-12-17 19:06:23', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:06:23', '2013-12-17 19:06:23', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:06:23', '2013-12-17 19:06:23', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:06:23 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:06:23', 'tst@tst', '2013-12-17 19:06:23')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:06:23', 'woop@tst.com', '2013-12-17 19:06:22', '2013-12-17 19:06:23')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"980190964"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com'[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.4ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (39.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (79.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (134.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (120.4ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (109.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (126.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:06:38', '2013-12-17 19:06:38', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:06:38', '2013-12-17 19:06:38', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:06:38', '2013-12-17 19:06:38', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:06:38', '2013-12-17 19:06:38', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:06:38', '2013-12-17 19:06:38', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:06:38', '2013-12-17 19:06:38', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:06:38', '2013-12-17 19:06:38', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:06:38', '2013-12-17 19:06:38', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:06:38 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:06:38', 'tst@tst', '2013-12-17 19:06:38')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:06:38', 'woop@tst.com', '2013-12-17 19:06:37', '2013-12-17 19:06:38')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"980190964"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1[0m
Completed 200 OK in 2ms (Views: 0.1ms | ActiveRecord: 0.3ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (54.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.7ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (91.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (230.8ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (97.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:07:18', '2013-12-17 19:07:18', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:07:18', '2013-12-17 19:07:18', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:07:18', '2013-12-17 19:07:18', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:07:18', '2013-12-17 19:07:18', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:07:18', '2013-12-17 19:07:18', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:07:18', '2013-12-17 19:07:18', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:07:18', '2013-12-17 19:07:18', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:07:18', '2013-12-17 19:07:18', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:07:18 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:07:18', 'tst@tst', '2013-12-17 19:07:18')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:07:18', 'woop@tst.com', '2013-12-17 19:07:17', '2013-12-17 19:07:18')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (14.0ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '7fb58dce-0f60-4027-b117-2c958a69f612', `updated_at` = '2013-12-17 19:07:18' WHERE `users`.`id` = 980190964[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 14.6ms)
  [1m[36m (4.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (48.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (89.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (243.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (143.4ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (117.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (118.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (161.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:08:00', '2013-12-17 19:08:00', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:08:00', '2013-12-17 19:08:00', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:08:00', '2013-12-17 19:08:00', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:08:00', '2013-12-17 19:08:00', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:08:00', '2013-12-17 19:08:00', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:08:00', '2013-12-17 19:08:00', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:08:00', '2013-12-17 19:08:00', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:08:00', '2013-12-17 19:08:00', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:08:00 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:08:00', 'tst@tst', '2013-12-17 19:08:00')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 0.5ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:08:00', 'woop@tst.com', '2013-12-17 19:07:59', '2013-12-17 19:08:00')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = 'de49990d-896b-4fbd-aefe-5963ce1aca07', `updated_at` = '2013-12-17 19:08:00' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (9.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (89.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (304.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (226.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (151.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (141.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (170.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:08:11', '2013-12-17 19:08:11', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:08:11', '2013-12-17 19:08:11', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:08:11', '2013-12-17 19:08:11', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:08:11', '2013-12-17 19:08:11', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:08:11', '2013-12-17 19:08:11', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:08:11', '2013-12-17 19:08:11', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:08:11', '2013-12-17 19:08:11', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:08:11', '2013-12-17 19:08:11', 298486374)[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:08:11 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:08:12', 'tst@tst', '2013-12-17 19:08:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:08:12', 'woop@tst.com', '2013-12-17 19:08:10', '2013-12-17 19:08:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '69453895-0cef-4c71-b6eb-93f1fff8c43f', `updated_at` = '2013-12-17 19:08:12' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (74.6ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.0ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (211.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (367.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (195.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (109.6ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (148.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (144.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:08:57', '2013-12-17 19:08:57', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:08:57', '2013-12-17 19:08:57', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:08:57', '2013-12-17 19:08:57', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:08:57', '2013-12-17 19:08:57', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:08:57', '2013-12-17 19:08:57', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:08:57', '2013-12-17 19:08:57', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:08:57', '2013-12-17 19:08:57', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:08:57', '2013-12-17 19:08:57', 298486374)[0m
  [1m[35m (28.8ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:08:57 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:08:57', 'tst@tst', '2013-12-17 19:08:57')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (15.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:08:57', 'woop@tst.com', '2013-12-17 19:08:55', '2013-12-17 19:08:57')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '9a5d5100-1952-4210-b96b-827922782edf', `updated_at` = '2013-12-17 19:08:57' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (115.6ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (10.9ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (274.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (253.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (119.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (109.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.4ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.2ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:53:49', '2013-12-17 19:53:49', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 19:53:49', '2013-12-17 19:53:49', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:53:49', '2013-12-17 19:53:49', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 19:53:49', '2013-12-17 19:53:49', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:53:49', '2013-12-17 19:53:49', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 19:53:49', '2013-12-17 19:53:49', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:53:49', '2013-12-17 19:53:49', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 19:53:49', '2013-12-17 19:53:49', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 13:53:49 -0600"}}
Unpermitted parameters: app_id, last_login
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`confirmation_hash`, `created_at`, `email`, `updated_at`) VALUES ('aaa', '2013-12-17 19:53:49', 'tst@tst', '2013-12-17 19:53:49')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
  [1m[36m (14.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 19:53:49', 'woop@tst.com', '2013-12-17 19:53:47', '2013-12-17 19:53:49')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = 'a8ce472c-5630-48ca-a021-992bfd89cf57', `updated_at` = '2013-12-17 19:53:49' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (4.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (314.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (21.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (421.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (193.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (162.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (105.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (162.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (229.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (7.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (1.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (1.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (18.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:19:08', '2013-12-17 22:19:08', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:19:08', '2013-12-17 22:19:08', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:19:08', '2013-12-17 22:19:08', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:19:08', '2013-12-17 22:19:08', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:19:08', '2013-12-17 22:19:08', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:19:08', '2013-12-17 22:19:08', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:19:08', '2013-12-17 22:19:08', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:19:08', '2013-12-17 22:19:08', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:19:08 -0600", "password_hash"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password_hash
Completed 500 Internal Server Error in 2ms
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36m (208.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.9ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (192.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (165.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (183.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (230.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (151.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (171.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (14.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (1.1ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (2.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:20:11', '2013-12-17 22:20:11', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:20:11', '2013-12-17 22:20:11', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:20:11', '2013-12-17 22:20:11', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:20:11', '2013-12-17 22:20:11', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:20:11', '2013-12-17 22:20:11', 980190962)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:20:11', '2013-12-17 22:20:11', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:20:11', '2013-12-17 22:20:11', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:20:11', '2013-12-17 22:20:11', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:20:11 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
Completed 500 Internal Server Error in 5ms
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (24.0ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:20:11', 'woop@tst.com', '2013-12-17 22:20:08', '2013-12-17 22:20:11')
  [1m[36m (0.5ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (31.0ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (31.5ms)[0m  UPDATE `users` SET `confirmation_hash` = '77ac9c49-2721-4fe9-a1bc-75cba3d637a2', `updated_at` = '2013-12-17 22:20:11' WHERE `users`.`id` = 980190963
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 106ms (Views: 0.3ms | ActiveRecord: 62.8ms)
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190963 LIMIT 1
  [1m[36m (11.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (78.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (184.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (248.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (124.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (237.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (160.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (178.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:20:41', '2013-12-17 22:20:41', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:20:41', '2013-12-17 22:20:41', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:20:41', '2013-12-17 22:20:41', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:20:41', '2013-12-17 22:20:41', 298486374)[0m
  [1m[35mFixture Delete (0.6ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:20:41', '2013-12-17 22:20:41', 980190962)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:20:41', '2013-12-17 22:20:41', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:20:41', '2013-12-17 22:20:41', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:20:41', '2013-12-17 22:20:41', 298486374)[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:20:41 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 22:20:41', 'tst@tst', '2013-12-17 22:20:41')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 12ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:20:41 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.2ms)
  [1m[36m (13.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:20:41', 'woop@tst.com', '2013-12-17 22:20:39', '2013-12-17 22:20:41')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '746dbee7-42ac-47d8-8774-7a6a044c73db', `updated_at` = '2013-12-17 22:20:41' WHERE `users`.`id` = 980190964
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.2ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (48.3ms)[0m  [1mROLLBACK[0m
  [1m[36m (112.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (102.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (217.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (106.1ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (128.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (139.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (15.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.7ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.9ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.3ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:21:36', '2013-12-17 22:21:36', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:21:36', '2013-12-17 22:21:36', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:21:36', '2013-12-17 22:21:36', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:21:36', '2013-12-17 22:21:36', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:21:36', '2013-12-17 22:21:36', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:21:36', '2013-12-17 22:21:36', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:21:36', '2013-12-17 22:21:36', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:21:36', '2013-12-17 22:21:36', 298486374)[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:21:36 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 22:21:36', 'tst@tst', '2013-12-17 22:21:36')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 29ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:21:36 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (10.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:21:36', 'woop@tst.com', '2013-12-17 22:21:34', '2013-12-17 22:21:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = 'dfbb9f3f-be27-47a0-8572-63f80821602c', `updated_at` = '2013-12-17 22:21:36' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (200.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (16.1ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (240.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (180.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (126.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (162.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.5ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (15.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (11.6ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:27:52', '2013-12-17 22:27:52', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:27:52', '2013-12-17 22:27:52', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:27:52', '2013-12-17 22:27:52', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:27:52', '2013-12-17 22:27:52', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:27:52', '2013-12-17 22:27:52', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:27:52', '2013-12-17 22:27:52', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:27:52', '2013-12-17 22:27:52', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:27:52', '2013-12-17 22:27:52', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:27:52 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[36mUser Load (1.9ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 22:27:53', 'tst@tst', '2013-12-17 22:27:53')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 76ms (Views: 0.2ms | ActiveRecord: 2.5ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:27:52 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.3ms | ActiveRecord: 2.9ms)
  [1m[36m (16.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:27:53', 'woop@tst.com', '2013-12-17 22:27:50', '2013-12-17 22:27:53')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `users` SET `confirmation_hash` = 'f90ad79a-bad9-472c-966f-7247f7f681d2', `updated_at` = '2013-12-17 22:27:53' WHERE `users`.`id` = 980190964
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.8ms)
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[36m (60.9ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (16.2ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (100.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (232.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (98.1ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (134.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.1ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.6ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:29:54', '2013-12-17 22:29:54', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:29:54', '2013-12-17 22:29:54', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.7ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:29:54', '2013-12-17 22:29:54', 980190962)
  [1m[36mFixture Insert (0.8ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:29:54', '2013-12-17 22:29:54', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:29:54', '2013-12-17 22:29:54', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:29:54', '2013-12-17 22:29:54', 298486374)
  [1m[36mFixture Delete (0.6ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:29:54', '2013-12-17 22:29:54', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:29:54', '2013-12-17 22:29:54', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:29:54 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 22:29:54', 'tst@tst', '2013-12-17 22:29:54')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 42ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:29:54 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.6ms | ActiveRecord: 2.0ms)
  [1m[36m (32.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:29:54', 'woop@tst.com', '2013-12-17 22:29:52', '2013-12-17 22:29:54')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  UPDATE `users` SET `confirmation_hash` = '12a6b846-7e18-4eb0-986c-b49b69f83f98', `updated_at` = '2013-12-17 22:29:54' WHERE `users`.`id` = 980190964
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 2.0ms)
  [1m[35mUser Load (2.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[36m (32.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (86.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (241.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (119.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (128.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (133.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (143.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.7ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:30:32', '2013-12-17 22:30:32', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:30:32', '2013-12-17 22:30:32', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:30:32', '2013-12-17 22:30:32', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:30:32', '2013-12-17 22:30:32', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:30:32', '2013-12-17 22:30:32', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:30:32', '2013-12-17 22:30:32', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:30:32', '2013-12-17 22:30:32', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:30:32', '2013-12-17 22:30:32', 298486374)[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:30:32 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 22:30:32', 'tst@tst', '2013-12-17 22:30:32')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:30:32 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.3ms | ActiveRecord: 1.6ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:30:32', 'woop@tst.com', '2013-12-17 22:30:31', '2013-12-17 22:30:32')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '7a281ee9-5948-4097-b820-be5c03686102', `updated_at` = '2013-12-17 22:30:32' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (46.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (96.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (162.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (115.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (136.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (128.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (153.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.2ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:30:57', '2013-12-17 22:30:57', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:30:57', '2013-12-17 22:30:57', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:30:57', '2013-12-17 22:30:57', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:30:57', '2013-12-17 22:30:57', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:30:57', '2013-12-17 22:30:57', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:30:57', '2013-12-17 22:30:57', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:30:57', '2013-12-17 22:30:57', 980190962)
  [1m[36mFixture Insert (0.9ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:30:57', '2013-12-17 22:30:57', 298486374)[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:30:57 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `updated_at`) VALUES ('2013-12-17 22:30:57', 'tst@tst', '2013-12-17 22:30:57')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.9ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:30:57 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id, last_login, password
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.5ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:30:57', 'woop@tst.com', '2013-12-17 22:30:56', '2013-12-17 22:30:57')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '99b62180-4811-44aa-b186-b7a5b882eba2', `updated_at` = '2013-12-17 22:30:57' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 1.2ms)
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[36m (92.6ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (210.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (96.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (134.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (128.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:32:33', '2013-12-17 22:32:33', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:32:33', '2013-12-17 22:32:33', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:32:33', '2013-12-17 22:32:33', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:32:33', '2013-12-17 22:32:33', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:32:33', '2013-12-17 22:32:33', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:32:33', '2013-12-17 22:32:33', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:32:33', '2013-12-17 22:32:33', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:32:33', '2013-12-17 22:32:33', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:32:33 -0600", "password"=>"[FILTERED]"}}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:32:34', 'tst@tst', '2013-12-17 22:32:33', '$2a$10$mrzbLiYzAyJX88WINsI.je5bpIgfZxIo7rRDC6ZTL5SDcuR4Q4hD6', '$2a$10$mrzbLiYzAyJX88WINsI.je', '2013-12-17 22:32:34')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 125ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:32:33 -0600", "password"=>"[FILTERED]"}}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.2ms)
  [1m[36m (32.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.4ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.5ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:32:34', 'woop@tst.com', '2013-12-17 22:32:32', '2013-12-17 22:32:34')
  [1m[36m (1.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '4c2a0847-1574-484a-b82c-e0a833a4d47f', `updated_at` = '2013-12-17 22:32:34' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (14.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (66.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (187.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (199.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (114.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (119.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (124.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (134.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.6ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:33:25', '2013-12-17 22:33:25', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:33:25', '2013-12-17 22:33:25', 298486374)
  [1m[36mFixture Delete (0.6ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:33:25', '2013-12-17 22:33:25', 980190962)
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:33:25', '2013-12-17 22:33:25', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:33:25', '2013-12-17 22:33:25', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:33:25', '2013-12-17 22:33:25', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:33:25', '2013-12-17 22:33:25', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:33:25', '2013-12-17 22:33:25', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:33:25 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:33:26', 'tst@tst', '2013-12-17 22:33:25', '$2a$10$f4osVCuQhwrNgBP4CiasB.B.sz6.Lp3j.6J4dwrmDLy8OW2ScOMjq', '$2a$10$f4osVCuQhwrNgBP4CiasB.', '2013-12-17 22:33:26')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 153ms (Views: 0.8ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.8ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:33:25 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 5ms (Views: 0.4ms | ActiveRecord: 1.7ms)
  [1m[36m (15.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:33:26', 'woop@tst.com', '2013-12-17 22:33:24', '2013-12-17 22:33:26')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = 'fd435a24-5c19-4107-a737-bb57afd04a85', `updated_at` = '2013-12-17 22:33:26' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (63.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.7ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (80.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (100.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (131.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (1.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:34:53', '2013-12-17 22:34:53', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:34:53', '2013-12-17 22:34:53', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:34:53', '2013-12-17 22:34:53', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:34:53', '2013-12-17 22:34:53', 298486374)[0m
  [1m[35mFixture Delete (0.7ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (1.4ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:34:53', '2013-12-17 22:34:53', 980190962)[0m
  [1m[35mFixture Insert (0.8ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:34:53', '2013-12-17 22:34:53', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:34:53', '2013-12-17 22:34:53', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:34:53', '2013-12-17 22:34:53', 298486374)[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.5ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:34:53 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:34:53', 'tst@tst', '2013-12-17 22:34:53', '$2a$10$SR6Y/2cIap9YYLnOY86aT.TtykIQu.JNnQJxMeGELIwDSysfFjhMO', '$2a$10$SR6Y/2cIap9YYLnOY86aT.', '2013-12-17 22:34:53')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 117ms (Views: 0.4ms | ActiveRecord: 1.5ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:34:53 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.3ms | ActiveRecord: 1.9ms)
  [1m[36m (16.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:34:53', 'woop@tst.com', '2013-12-17 22:34:51', '2013-12-17 22:34:53')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `users` SET `confirmation_hash` = '8b581c0c-d5f7-4ff1-9ffb-dea62752b8ff', `updated_at` = '2013-12-17 22:34:53' WHERE `users`.`id` = 980190964
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 1.5ms)
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (94.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (16.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (142.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (288.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (193.4ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (139.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (143.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (126.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:35:10', '2013-12-17 22:35:10', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:35:10', '2013-12-17 22:35:10', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:35:10', '2013-12-17 22:35:10', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:35:10', '2013-12-17 22:35:10', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:35:10', '2013-12-17 22:35:10', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:35:10', '2013-12-17 22:35:10', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:35:10', '2013-12-17 22:35:10', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:35:10', '2013-12-17 22:35:10', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:35:10 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:35:10', 'tst@tst', '2013-12-17 22:35:10', '$2a$10$rLL6aVN.iIuHPjL2WMZmcOqxnP.OmbsYWsdqZyNkKWMT2fttdIfna', '$2a$10$rLL6aVN.iIuHPjL2WMZmcO', '2013-12-17 22:35:10')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 139ms (Views: 0.2ms | ActiveRecord: 2.1ms)
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:35:10 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.3ms | ActiveRecord: 2.6ms)
  [1m[36m (16.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:35:10', 'woop@tst.com', '2013-12-17 22:35:08', '2013-12-17 22:35:10')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '250270cd-144a-4576-a591-0161b52b55b5', `updated_at` = '2013-12-17 22:35:10' WHERE `users`.`id` = 980190964
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190964 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (66.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (181.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (191.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (144.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (95.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (136.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.5ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (12.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (127.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (230.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (118.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (103.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (118.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (136.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (1.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.8ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:41:15', '2013-12-17 22:41:15', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:41:15', '2013-12-17 22:41:15', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:41:15', '2013-12-17 22:41:15', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:41:15', '2013-12-17 22:41:15', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (1.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:41:15', '2013-12-17 22:41:15', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:41:15', '2013-12-17 22:41:15', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:41:15', '2013-12-17 22:41:15', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:41:15', '2013-12-17 22:41:15', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:41:15 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:41:15', 'tst@tst', '2013-12-17 22:41:15', '$2a$10$Ju4ocfUQYLRNB7S8ClaRoOOT87G7bIIn6VByG98v/06yaS/l5JaR.', '$2a$10$Ju4ocfUQYLRNB7S8ClaRoO', '2013-12-17 22:41:15')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 91ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:41:15 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:41:15', 'woop@tst.com', '2013-12-17 22:41:13', '$2a$10$k5nV0qxMiVnyw4uIdI1d2umXIoM8X2a6r2xjpoIMo6UhjuFjHLqZO', '$2a$10$k5nV0qxMiVnyw4uIdI1d2u', '2013-12-17 22:41:15')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
Completed 500 Internal Server Error in 1ms
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:41:15', 'woop@tst.com', '2013-12-17 22:41:13', '2013-12-17 22:41:15')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = 'fdeb8be5-e332-41be-b09f-6bb969aaf621', `updated_at` = '2013-12-17 22:41:15' WHERE `users`.`id` = 980190965[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190965 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (37.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (86.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (176.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (118.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (134.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (134.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.7ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:41:28', '2013-12-17 22:41:28', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:41:28', '2013-12-17 22:41:28', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:41:28', '2013-12-17 22:41:28', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:41:28', '2013-12-17 22:41:28', 298486374)[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (1.0ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:41:28', '2013-12-17 22:41:28', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:41:28', '2013-12-17 22:41:28', 298486374)
  [1m[36mFixture Delete (1.0ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.9ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:41:28', '2013-12-17 22:41:28', 980190962)
  [1m[36mFixture Insert (1.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:41:28', '2013-12-17 22:41:28', 298486374)[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:41:28 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:41:28', 'tst@tst', '2013-12-17 22:41:28', '$2a$10$TE2x4.vCMj7uKQ6hNcfrn.5X7aZmDp0UJWn6EXFam78K1Rv24LGQO', '$2a$10$TE2x4.vCMj7uKQ6hNcfrn.', '2013-12-17 22:41:28')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 86ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:41:28 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.2ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:41:28', 'woop@tst.com', '2013-12-17 22:41:27', '$2a$10$keZ9aGoTyx7mUCPw1SESeOsPji3.s4QsRq9veq9kf/nVMxb3Ip452', '$2a$10$keZ9aGoTyx7mUCPw1SESeO', '2013-12-17 22:41:28')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 77ms (Views: 0.3ms | ActiveRecord: 0.3ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:41:28', 'woop@tst.com', '2013-12-17 22:41:27', '2013-12-17 22:41:28')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.9ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '49dedd23-333c-49f1-8609-8472bacb0853', `updated_at` = '2013-12-17 22:41:28' WHERE `users`.`id` = 980190965
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 1.8ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190965 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (70.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (220.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (117.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (117.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (127.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:41:40', '2013-12-17 22:41:40', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:41:40', '2013-12-17 22:41:40', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:41:40', '2013-12-17 22:41:40', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:41:40', '2013-12-17 22:41:40', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:41:40', '2013-12-17 22:41:40', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:41:40', '2013-12-17 22:41:40', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:41:40', '2013-12-17 22:41:40', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:41:40', '2013-12-17 22:41:40', 298486374)[0m
  [1m[35m (2.4ms)[0m  COMMIT
  [1m[36m (0.8ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:41:40 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:41:40', 'tst@tst', '2013-12-17 22:41:40', '$2a$10$hdpExnd8SSQ9NS/RaBnLwepm0O8ppuL9UfiYeJOJu28CWtF0/.nI2', '$2a$10$hdpExnd8SSQ9NS/RaBnLwe', '2013-12-17 22:41:40')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 89ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:41:40 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:41:40', 'woop@tst.com', '2013-12-17 22:41:39', '$2a$10$hxNzOk6oYxdUPOT6QPQPiumk/p/1mFf.oFNlwWtzrufiOuh6DOugy', '$2a$10$hxNzOk6oYxdUPOT6QPQPiu', '2013-12-17 22:41:40')
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.6ms | ActiveRecord: 0.3ms)
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.4ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:41:40', 'woop@tst.com', '2013-12-17 22:41:39', '2013-12-17 22:41:40')
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  UPDATE `users` SET `confirmation_hash` = '6b200675-4d20-46ad-9830-1c017cc6392d', `updated_at` = '2013-12-17 22:41:40' WHERE `users`.`id` = 980190965
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.6ms | ActiveRecord: 1.9ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190965 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (11.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (118.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (220.8ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (110.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (158.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (128.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:42:20', '2013-12-17 22:42:20', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:42:20', '2013-12-17 22:42:20', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:42:20', '2013-12-17 22:42:20', 980190962)
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:42:20', '2013-12-17 22:42:20', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:42:20', '2013-12-17 22:42:20', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:42:20', '2013-12-17 22:42:20', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.7ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:42:20', '2013-12-17 22:42:20', 980190962)
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:42:20', '2013-12-17 22:42:20', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:42:20 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:42:20', 'tst@tst', '2013-12-17 22:42:20', '$2a$10$GuVYYYW8vSg4T7y8XWGSOe8NgKu2WWXo8gQpwUh0IKqRoLHcOenN2', '$2a$10$GuVYYYW8vSg4T7y8XWGSOe', '2013-12-17 22:42:20')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 88ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:42:20 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[36m (1.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:42:20', 'woop@tst.com', '2013-12-17 22:42:19', '$2a$10$ltbldaigpRWvyIglPyqNj.wZm8G9goqd43.eJxT0qmJvevvCHf0ye', '$2a$10$ltbldaigpRWvyIglPyqNj.', '2013-12-17 22:42:20')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.5ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.7ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 500 Internal Server Error in 75ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:42:20', 'woop@tst.com', '2013-12-17 22:42:19', '2013-12-17 22:42:20')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '2cd63a9b-6b6e-47e1-bd5f-0c066735466b', `updated_at` = '2013-12-17 22:42:20' WHERE `users`.`id` = 980190965[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 2.1ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190965 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (32.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (126.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (199.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (92.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (130.6ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (133.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (152.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (1.2ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.1ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:42:41', '2013-12-17 22:42:41', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:42:41', '2013-12-17 22:42:41', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:42:41', '2013-12-17 22:42:41', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:42:41', '2013-12-17 22:42:41', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:42:41', '2013-12-17 22:42:41', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:42:41', '2013-12-17 22:42:41', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:42:41', '2013-12-17 22:42:41', 980190962)
  [1m[36mFixture Insert (1.6ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:42:41', '2013-12-17 22:42:41', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:42:41 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:42:41', 'tst@tst', '2013-12-17 22:42:41', '$2a$10$sN315t6DGDR/KxsjaMevAO3qXMpneZwzpjS8o6cyhv/QvDLRyZJv2', '$2a$10$sN315t6DGDR/KxsjaMevAO', '2013-12-17 22:42:41')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 96ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:42:41 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.5ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:42:41', 'woop@tst.com', '2013-12-17 22:42:40', '$2a$10$2qnb8QyW6k6DEmvoWK4Twu1N79ReswAuCo9ZIg3tj1Kf.EruIqd.q', '$2a$10$2qnb8QyW6k6DEmvoWK4Twu', '2013-12-17 22:42:41')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.4ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.4ms | ActiveRecord: 0.9ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:42:41', 'woop@tst.com', '2013-12-17 22:42:40', '2013-12-17 22:42:41')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '0c79281e-0d27-4ca0-9234-a7460e7dc422', `updated_at` = '2013-12-17 22:42:41' WHERE `users`.`id` = 980190965[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.4ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190965 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (55.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (160.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (177.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (147.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (116.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (190.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (1.0ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.9ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:49:16', '2013-12-17 22:49:16', 980190962)[0m
  [1m[35mFixture Insert (1.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:49:16', '2013-12-17 22:49:16', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.5ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:49:16', '2013-12-17 22:49:16', 980190962)
  [1m[36mFixture Insert (0.8ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:49:16', '2013-12-17 22:49:16', 298486374)[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:49:16', '2013-12-17 22:49:16', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:49:16', '2013-12-17 22:49:16', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:49:16', '2013-12-17 22:49:16', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:49:16', '2013-12-17 22:49:16', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:49:16 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:49:16', 'tst@tst', '2013-12-17 22:49:16', '$2a$10$9vCfzisYj3m1iMh0A7KPs.kXqWbNRkXt4tOO8csFAQs99ZV8kAD5C', '$2a$10$9vCfzisYj3m1iMh0A7KPs.', '2013-12-17 22:49:16')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 91ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:49:16 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:49:16', 'woop@tst.com', '2013-12-17 22:49:15', '$2a$10$asyWlO2vYtDhNo8foiLFNun/ZznvCdqbKLMVUg0/0z6zkcEHT88Ae', '$2a$10$asyWlO2vYtDhNo8foiLFNu', '2013-12-17 22:49:16')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (1.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:49:17', 'woop@tst.com', '2013-12-17 22:49:15', '2013-12-17 22:49:17')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (16.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:49:17', 'woop@tst.com', '2013-12-17 22:49:15', '2013-12-17 22:49:17')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = 'edf9d997-42af-4f5a-9ab6-e95e0f9c2df2', `updated_at` = '2013-12-17 22:49:17' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (66.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (91.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (162.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (135.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (117.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (128.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.7ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:50:10', '2013-12-17 22:50:10', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:50:10', '2013-12-17 22:50:10', 298486374)
  [1m[36mFixture Delete (0.7ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:50:10', '2013-12-17 22:50:10', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:50:10', '2013-12-17 22:50:10', 298486374)[0m
  [1m[35mFixture Delete (0.6ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:50:10', '2013-12-17 22:50:10', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:50:10', '2013-12-17 22:50:10', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:50:10', '2013-12-17 22:50:10', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:50:10', '2013-12-17 22:50:10', 298486374)[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (2.0ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:50:10 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:50:10', 'tst@tst', '2013-12-17 22:50:10', '$2a$10$9TL3xZkOjANMo35aDNsMEuWVJhl2whRf7.b5dsBTpyWKklh67dnZW', '$2a$10$9TL3xZkOjANMo35aDNsMEu', '2013-12-17 22:50:10')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 102ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:50:10 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.5ms)
  [1m[36m (15.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:50:10', 'woop@tst.com', '2013-12-17 22:50:08', '$2a$10$dKRerOa2xQ.kMpmt/yxOSePmkKExYjtUIhRlVtzydQC.qHG61Pfru', '$2a$10$dKRerOa2xQ.kMpmt/yxOSe', '2013-12-17 22:50:10')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:50:10', 'woop@tst.com', '2013-12-17 22:50:08', '2013-12-17 22:50:10')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (1.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.6ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:50:10', 'woop@tst.com', '2013-12-17 22:50:08', '2013-12-17 22:50:10')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `users` SET `confirmation_hash` = '2b20cf5d-a721-4c24-a6cf-daa97d7fa18d', `updated_at` = '2013-12-17 22:50:10' WHERE `users`.`id` = 980190966
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.7ms)
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (8.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (118.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (177.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (122.1ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (130.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (143.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.5ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:51:12', '2013-12-17 22:51:12', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:51:12', '2013-12-17 22:51:12', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:51:12', '2013-12-17 22:51:12', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:51:12', '2013-12-17 22:51:12', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:51:12', '2013-12-17 22:51:12', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:51:12', '2013-12-17 22:51:12', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:51:12', '2013-12-17 22:51:12', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:51:12', '2013-12-17 22:51:12', 298486374)[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:51:12 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:51:12', 'tst@tst', '2013-12-17 22:51:12', '$2a$10$5pBTRXsuBPiR1g465XxtUeHiU2LVJVJeBkw5qZ5jq95BKCkvvJ43q', '$2a$10$5pBTRXsuBPiR1g465XxtUe', '2013-12-17 22:51:12')[0m
  [1m[35m (0.8ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 88ms (Views: 0.5ms | ActiveRecord: 1.6ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:51:12 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 2.0ms)
  [1m[36m (1.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:51:12', 'woop@tst.com', '2013-12-17 22:51:11', '$2a$10$gg8ZMGBmKqa7xRatiY4uxujOogmJO90QtI0JB9osqiNMD4dbZXpcC', '$2a$10$gg8ZMGBmKqa7xRatiY4uxu', '2013-12-17 22:51:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.9ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 78ms (Views: 0.2ms | ActiveRecord: 0.9ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`) VALUES ('2013-12-17 22:51:12', 13.0, '010010101010', '2013-12-17 22:51:11', 1, '2013-12-17 22:51:12')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>"980190963"}
Unpermitted parameters: subscription
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms)
  [1m[36m (1.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:51:12', 'woop@tst.com', '2013-12-17 22:51:11', '2013-12-17 22:51:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '1584f6f7-50b2-4721-ae77-f317b1a1b06c', `updated_at` = '2013-12-17 22:51:12' WHERE `users`.`id` = 980190965
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.6ms | ActiveRecord: 1.9ms)
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190965 LIMIT 1
  [1m[36m (1.3ms)[0m  [1mROLLBACK[0m
  [1m[36m (136.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.7ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (100.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (188.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (119.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (120.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (145.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (156.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (18.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (15.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (15.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.6ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.8ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:51:53', '2013-12-17 22:51:53', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:51:53', '2013-12-17 22:51:53', 298486374)
  [1m[36mFixture Delete (1.0ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.5ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:51:53', '2013-12-17 22:51:53', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:51:53', '2013-12-17 22:51:53', 298486374)[0m
  [1m[35mFixture Delete (0.6ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:51:53', '2013-12-17 22:51:53', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:51:53', '2013-12-17 22:51:53', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:51:53', '2013-12-17 22:51:53', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:51:53', '2013-12-17 22:51:53', 298486374)[0m
  [1m[35m (6.2ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:51:53 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:51:53', 'tst@tst', '2013-12-17 22:51:53', '$2a$10$IWQNdcIp/MTOaGUB1CKqw.3WaFzf704WDUL8DCtt2l9l866jJEITS', '$2a$10$IWQNdcIp/MTOaGUB1CKqw.', '2013-12-17 22:51:53')[0m
  [1m[35m (0.6ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 131ms (Views: 0.3ms | ActiveRecord: 1.8ms)
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:51:53 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.2ms | ActiveRecord: 2.1ms)
  [1m[36m (15.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:51:54', 'woop@tst.com', '2013-12-17 22:51:51', '$2a$10$kf6mrOdbMm7OejYX2eJrNeFYGHr6i.tn75q4Cpmblm22aGLzuob.y', '$2a$10$kf6mrOdbMm7OejYX2eJrNe', '2013-12-17 22:51:54')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 74ms (Views: 0.6ms | ActiveRecord: 0.7ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:51:54', 'woop@tst.com', '2013-12-17 22:51:51', '2013-12-17 22:51:54')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (31.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:51:54', 'woop@tst.com', '2013-12-17 22:51:51', '2013-12-17 22:51:54')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '1f49ded7-452b-4cfd-b23b-0c3f7d9a66cd', `updated_at` = '2013-12-17 22:51:54' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (11.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (123.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (139.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (166.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (130.9ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (155.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (135.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.5ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:52:05', '2013-12-17 22:52:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:52:05', '2013-12-17 22:52:05', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:52:05', '2013-12-17 22:52:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:52:05', '2013-12-17 22:52:05', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:52:05', '2013-12-17 22:52:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:52:05', '2013-12-17 22:52:05', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:52:05', '2013-12-17 22:52:05', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:52:05', '2013-12-17 22:52:05', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:52:05 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:52:05', 'tst@tst', '2013-12-17 22:52:05', '$2a$10$yDFnlPzHtT1dqk1DBYqeEeRdKFGMdLmwfR4jSnfcXKdHWLv0yNCCW', '$2a$10$yDFnlPzHtT1dqk1DBYqeEe', '2013-12-17 22:52:05')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 90ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:52:05 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.5ms | ActiveRecord: 1.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:52:06', 'woop@tst.com', '2013-12-17 22:52:04', '$2a$10$gkA3nCG7rVyMJZzNrJ07e.4jaPAW5QfvZ/949SddCJgoVL0g1zL9m', '$2a$10$gkA3nCG7rVyMJZzNrJ07e.', '2013-12-17 22:52:06')
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.2ms | ActiveRecord: 0.7ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:52:06', 'woop@tst.com', '2013-12-17 22:52:04', '2013-12-17 22:52:06')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:52:06', 'woop@tst.com', '2013-12-17 22:52:04', '2013-12-17 22:52:06')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = 'b9893aac-e26e-4b6f-b85b-c7b6dab30174', `updated_at` = '2013-12-17 22:52:06' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (65.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (96.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (172.8ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (154.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (158.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:53:08', '2013-12-17 22:53:08', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:53:08', '2013-12-17 22:53:08', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:53:08', '2013-12-17 22:53:08', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:53:08', '2013-12-17 22:53:08', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:53:08', '2013-12-17 22:53:08', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:53:08', '2013-12-17 22:53:08', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:53:08', '2013-12-17 22:53:08', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:53:08', '2013-12-17 22:53:08', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:53:08 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:53:08', 'tst@tst', '2013-12-17 22:53:08', '$2a$10$UEJmgGS3/PMPqseXhbz7veO7xfaMSCVLYfqSXsxdK1s7X/l4OpsZK', '$2a$10$UEJmgGS3/PMPqseXhbz7ve', '2013-12-17 22:53:08')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 85ms (Views: 0.4ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:53:08 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:53:08', 'woop@tst.com', '2013-12-17 22:53:07', '$2a$10$F4B1ref5imn0hg6ea9YfHueTx0/K8rXnpLwE1YGxLES./SIKhj8c.', '$2a$10$F4B1ref5imn0hg6ea9YfHu', '2013-12-17 22:53:08')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:53:08', 'woop@tst.com', '2013-12-17 22:53:07', '2013-12-17 22:53:08')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 22:53:08', 13.0, '010010101010', '2013-12-17 22:53:07', 1, '2013-12-17 22:53:08', 980190965)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>"980190963"}
Unpermitted parameters: subscription
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms)
  [1m[35m (15.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:53:08', 'woop@tst.com', '2013-12-17 22:53:07', '2013-12-17 22:53:08')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '4cf2b2ba-8854-4d9d-bb93-6927a4460929', `updated_at` = '2013-12-17 22:53:08' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (62.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (151.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (158.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (120.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (119.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (153.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.5ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.8ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:54:56', '2013-12-17 22:54:56', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:54:56', '2013-12-17 22:54:56', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:54:56', '2013-12-17 22:54:56', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:54:56', '2013-12-17 22:54:56', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.8ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:54:56', '2013-12-17 22:54:56', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:54:56', '2013-12-17 22:54:56', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:54:56', '2013-12-17 22:54:56', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:54:56', '2013-12-17 22:54:56', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:54:56 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:54:56', 'tst@tst', '2013-12-17 22:54:56', '$2a$10$EmCmqFZmRS00fWO8fnOaDOY/E2M6kMQAXA4K4nD4z8R/YGq7/ZjDO', '$2a$10$EmCmqFZmRS00fWO8fnOaDO', '2013-12-17 22:54:56')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 113ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:54:56 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:54:56', 'woop@tst.com', '2013-12-17 22:54:55', '$2a$10$sH3QOzt3RD6YVdcCBlDgGugtH4Yqo04Ro.8noZnaV2xVFY0t7iOsm', '$2a$10$sH3QOzt3RD6YVdcCBlDgGu', '2013-12-17 22:54:56')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:54:56', 'woop@tst.com', '2013-12-17 22:54:55', '2013-12-17 22:54:56')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 22:54:56', 13.0, '010010101010', '2013-12-17 22:54:55', 1, '2013-12-17 22:54:56', 980190965)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>"980190963"}
Unpermitted parameters: subscription
  [1m[35mSubscription Load (5.8ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 5.8ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:54:56', 'woop@tst.com', '2013-12-17 22:54:55', '2013-12-17 22:54:56')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = 'a062c15a-2cad-4b82-ad2c-9cc7f2fa9d11', `updated_at` = '2013-12-17 22:54:56' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (1.1ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[36m (69.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (1.0ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (86.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (229.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (139.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (119.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (129.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (141.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.8ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.4ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.3ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.5ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:55:13', '2013-12-17 22:55:13', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:55:13', '2013-12-17 22:55:13', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:55:13', '2013-12-17 22:55:13', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:55:13', '2013-12-17 22:55:13', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:55:13', '2013-12-17 22:55:13', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:55:13', '2013-12-17 22:55:13', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:55:13', '2013-12-17 22:55:13', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:55:13', '2013-12-17 22:55:13', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:55:13 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:55:13', 'tst@tst', '2013-12-17 22:55:13', '$2a$10$AVIrLbbKKqRLc.Qm4bx3DuXM0e/iJJGqFyxulO36o1hKg5a2f13Oy', '$2a$10$AVIrLbbKKqRLc.Qm4bx3Du', '2013-12-17 22:55:13')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 86ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:55:13 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:55:13', 'woop@tst.com', '2013-12-17 22:55:12', '$2a$10$voeRwjsul3RL4.gry9f.VOIqgEGz21wIDdOzJBYJsY/6ktsDeGoEC', '$2a$10$voeRwjsul3RL4.gry9f.VO', '2013-12-17 22:55:13')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 74ms (Views: 0.4ms | ActiveRecord: 0.6ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:55:14', 'woop@tst.com', '2013-12-17 22:55:12', '2013-12-17 22:55:14')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 22:55:14', 13.0, '010010101010', '2013-12-17 22:55:12', 1, '2013-12-17 22:55:14', 980190965)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>"980190963"}
Unpermitted parameters: subscription
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>"980190963"}
Unpermitted parameters: subscription
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL[0m
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:55:14', 'woop@tst.com', '2013-12-17 22:55:12', '2013-12-17 22:55:14')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '0f854ee8-a5a1-4b63-82d8-fe343244d0b5', `updated_at` = '2013-12-17 22:55:14' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 1.8ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (55.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (72.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (113.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (115.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (120.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (143.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (133.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.9ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (1.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (1.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.2ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.8ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.8ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:56:35', '2013-12-17 22:56:35', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:56:35', '2013-12-17 22:56:35', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:56:35', '2013-12-17 22:56:35', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:56:35', '2013-12-17 22:56:35', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:56:35', '2013-12-17 22:56:35', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:56:35', '2013-12-17 22:56:35', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:56:35', '2013-12-17 22:56:35', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:56:35', '2013-12-17 22:56:35', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:56:35 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:56:35', 'tst@tst', '2013-12-17 22:56:35', '$2a$10$cUiQLI4XvYaCgkitqZBygOF5bgp6oUgGP/2HUbtaEbUzZU8MsJ8jK', '$2a$10$cUiQLI4XvYaCgkitqZBygO', '2013-12-17 22:56:35')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 92ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:56:35 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:56:35', 'woop@tst.com', '2013-12-17 22:56:34', '$2a$10$61CQpEIK9S.TPxNXPRaF1uMBo0/GHKf0TlHR1ctcyym6OOr1rogv.', '$2a$10$61CQpEIK9S.TPxNXPRaF1u', '2013-12-17 22:56:35')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 74ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:56:36', 'woop@tst.com', '2013-12-17 22:56:34', '2013-12-17 22:56:36')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>nil, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.5ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.5ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>nil, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.8ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:56:36', 'woop@tst.com', '2013-12-17 22:56:34', '2013-12-17 22:56:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '2e342b28-1da2-4c5f-93ea-c1d8d35e44fa', `updated_at` = '2013-12-17 22:56:36' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (1.1ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[36m (61.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (1.1ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (67.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (149.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (109.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (111.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (106.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (117.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:57:07', '2013-12-17 22:57:07', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:57:07', '2013-12-17 22:57:07', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:57:07', '2013-12-17 22:57:07', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:57:07', '2013-12-17 22:57:07', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:57:07', '2013-12-17 22:57:07', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:57:07', '2013-12-17 22:57:07', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:57:07', '2013-12-17 22:57:07', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:57:07', '2013-12-17 22:57:07', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:57:07 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (1.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:57:08', 'tst@tst', '2013-12-17 22:57:07', '$2a$10$7tz7ZJal10xlgzfw6w5jDOF3Ybyiieis3rY3CYFM3x8Xi4DiyV2D.', '$2a$10$7tz7ZJal10xlgzfw6w5jDO', '2013-12-17 22:57:08')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 99ms (Views: 0.4ms | ActiveRecord: 2.2ms)
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:57:07 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 5ms (Views: 0.3ms | ActiveRecord: 2.6ms)
  [1m[36m (1.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:57:08', 'woop@tst.com', '2013-12-17 22:57:06', '$2a$10$JnaIlskr0ZS7pAvc/V6txetje2vpfRnTqDhYHX/asKqV7NoFUsRku', '$2a$10$JnaIlskr0ZS7pAvc/V6txe', '2013-12-17 22:57:08')
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:57:08', 'woop@tst.com', '2013-12-17 22:57:06', '2013-12-17 22:57:08')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>nil, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>nil, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL
Completed 200 OK in 1ms (Views: 0.1ms | ActiveRecord: 0.7ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:57:08', 'woop@tst.com', '2013-12-17 22:57:06', '2013-12-17 22:57:08')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '7bcebe56-2a94-4997-8af4-8ac286434da3', `updated_at` = '2013-12-17 22:57:08' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (65.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (100.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (203.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (131.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (145.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.9ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.5ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.5ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:59:17', '2013-12-17 22:59:17', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:59:17', '2013-12-17 22:59:17', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:59:17', '2013-12-17 22:59:17', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:59:17', '2013-12-17 22:59:17', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:59:17', '2013-12-17 22:59:17', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:59:17', '2013-12-17 22:59:17', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:59:17', '2013-12-17 22:59:17', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:59:17', '2013-12-17 22:59:17', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:59:17 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.8ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:59:17', 'tst@tst', '2013-12-17 22:59:17', '$2a$10$HogL598aOPD1ebXO1eO4l.f6TLB2wpMy1hCbHZkvrahDq7foRtUt6', '$2a$10$HogL598aOPD1ebXO1eO4l.', '2013-12-17 22:59:17')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 95ms (Views: 0.3ms | ActiveRecord: 2.0ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:59:17 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 2.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:59:17', 'woop@tst.com', '2013-12-17 22:59:16', '$2a$10$I29b7jdavVlVyRWegmvFqusCI4E97MatLiw36VEv6cfEZEFRxh/ji', '$2a$10$I29b7jdavVlVyRWegmvFqu', '2013-12-17 22:59:17')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:59:17', 'woop@tst.com', '2013-12-17 22:59:16', '2013-12-17 22:59:17')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>nil, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.7ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.7ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>nil, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.7ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL
Completed 200 OK in 3ms (Views: 0.6ms | ActiveRecord: 1.5ms)
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:59:17', 'woop@tst.com', '2013-12-17 22:59:16', '2013-12-17 22:59:17')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = 'de097dff-26d1-4700-b21a-8f7e967bd39c', `updated_at` = '2013-12-17 22:59:17' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (52.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (203.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (219.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (123.1ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (122.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (129.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (141.3ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:59:31', '2013-12-17 22:59:31', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:59:31', '2013-12-17 22:59:31', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:59:31', '2013-12-17 22:59:31', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:59:31', '2013-12-17 22:59:31', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:59:31', '2013-12-17 22:59:31', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:59:31', '2013-12-17 22:59:31', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.7ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:59:31', '2013-12-17 22:59:31', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:59:31', '2013-12-17 22:59:31', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:59:31 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:59:32', 'tst@tst', '2013-12-17 22:59:31', '$2a$10$PNAWNyrqrY9usk23mGXo8uTWMKhfi4hei1eFOJTjCe3jm.9DMMLzu', '$2a$10$PNAWNyrqrY9usk23mGXo8u', '2013-12-17 22:59:32')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 108ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:59:31 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36m (15.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.4ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:59:32', 'woop@tst.com', '2013-12-17 22:59:30', '$2a$10$D/hrE4CIpcQ1xASlk68PQuFBj427VO7LLTQs6ILFPLobVypR3B6JG', '$2a$10$D/hrE4CIpcQ1xASlk68PQu', '2013-12-17 22:59:32')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.4ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:59:32', 'woop@tst.com', '2013-12-17 22:59:30', '2013-12-17 22:59:32')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>nil, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>nil, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.5ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 0.8ms)
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:59:32', 'woop@tst.com', '2013-12-17 22:59:30', '2013-12-17 22:59:32')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '9bcb0b67-f2b2-45ff-8614-e62e84b5a3ae', `updated_at` = '2013-12-17 22:59:32' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[35mUser Load (1.1ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[36m (13.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.9ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (87.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (162.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (125.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (128.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.5ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.3ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:59:51', '2013-12-17 22:59:51', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 22:59:51', '2013-12-17 22:59:51', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:59:51', '2013-12-17 22:59:51', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 22:59:51', '2013-12-17 22:59:51', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:59:51', '2013-12-17 22:59:51', 980190962)[0m
  [1m[35mFixture Insert (0.5ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 22:59:51', '2013-12-17 22:59:51', 298486374)
  [1m[36mFixture Delete (0.7ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:59:51', '2013-12-17 22:59:51', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 22:59:51', '2013-12-17 22:59:51', 298486374)[0m
  [1m[35m (0.8ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:59:51 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.7ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.2ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 22:59:51', 'tst@tst', '2013-12-17 22:59:51', '$2a$10$VTypz.sS3sRG7vsQ2b1queqTtq8Tb.J8RC0GwjyHB/d2rrD1vzbbm', '$2a$10$VTypz.sS3sRG7vsQ2b1que', '2013-12-17 22:59:51')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 93ms (Views: 0.5ms | ActiveRecord: 2.5ms)
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 16:59:51 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.8ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 6ms (Views: 0.4ms | ActiveRecord: 3.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 22:59:51', 'woop@tst.com', '2013-12-17 22:59:50', '$2a$10$d5wmZa8Eh41Ej4EwJuUl7.dneEGmY8tqlpGvE2HDrimg9QT7050Fq', '$2a$10$d5wmZa8Eh41Ej4EwJuUl7.', '2013-12-17 22:59:51')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 77ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:59:51', 'woop@tst.com', '2013-12-17 22:59:50', '2013-12-17 22:59:51')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 22:59:50 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 22:59:50 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 22:59:51', 'woop@tst.com', '2013-12-17 22:59:50', '2013-12-17 22:59:51')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `users` SET `confirmation_hash` = '994b35b5-852f-44e6-a0a2-229cff75e69e', `updated_at` = '2013-12-17 22:59:51' WHERE `users`.`id` = 980190966
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 1.8ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (39.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (200.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (183.8ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (122.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (124.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (118.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (183.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.5ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:00:05', '2013-12-17 23:00:05', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:00:05', '2013-12-17 23:00:05', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:00:05', '2013-12-17 23:00:05', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:00:05', '2013-12-17 23:00:05', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:00:05', '2013-12-17 23:00:05', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:00:05', '2013-12-17 23:00:05', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:00:05', '2013-12-17 23:00:05', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:00:05', '2013-12-17 23:00:05', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:00:05 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:00:06', 'tst@tst', '2013-12-17 23:00:05', '$2a$10$Uw6AnHLw.dkUMBUBj.dmxueKUHlNwnM3kJ5M.q2xLhvBeJZS3DPMO', '$2a$10$Uw6AnHLw.dkUMBUBj.dmxu', '2013-12-17 23:00:06')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 137ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:00:05 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 5ms (Views: 0.3ms | ActiveRecord: 1.5ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:00:06', 'woop@tst.com', '2013-12-17 23:00:04', '$2a$10$xks8ON1wZejw.1xQ7yPf4OQFrjNEcJ1HEpP.2sCrNVE3hp9Grg0R6', '$2a$10$xks8ON1wZejw.1xQ7yPf4O', '2013-12-17 23:00:06')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 74ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (1.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:00:06', 'woop@tst.com', '2013-12-17 23:00:04', '2013-12-17 23:00:06')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:00:04 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.6ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
Completed 200 OK in 3ms (Views: 0.3ms | ActiveRecord: 0.6ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:00:04 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.8ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 1.4ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:00:06', 'woop@tst.com', '2013-12-17 23:00:04', '2013-12-17 23:00:06')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.8ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '59308ec3-0f29-4a98-aa29-a50f6e4d8b27', `updated_at` = '2013-12-17 23:00:06' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 1.6ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (16.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (145.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (221.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (125.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (119.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (126.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:00:27', '2013-12-17 23:00:27', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:00:27', '2013-12-17 23:00:27', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:00:27', '2013-12-17 23:00:27', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:00:27', '2013-12-17 23:00:27', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:00:27', '2013-12-17 23:00:27', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:00:27', '2013-12-17 23:00:27', 298486374)
  [1m[36mFixture Delete (1.0ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (1.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:00:27', '2013-12-17 23:00:27', 980190962)
  [1m[36mFixture Insert (2.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:00:27', '2013-12-17 23:00:27', 298486374)[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:00:27 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:00:27', 'tst@tst', '2013-12-17 23:00:27', '$2a$10$rhvMdcR1ZhsSn0zVAr/Xh.A.l1aWWLMadvTHbdY4c4a4kjHkGYPNS', '$2a$10$rhvMdcR1ZhsSn0zVAr/Xh.', '2013-12-17 23:00:27')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 87ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:00:27 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:00:27', 'woop@tst.com', '2013-12-17 23:00:26', '$2a$10$3Hl6f53zSMf0UQZcjrj8zevybmzn7BPDWdYznV.pUR25oKvBZI.eC', '$2a$10$3Hl6f53zSMf0UQZcjrj8ze', '2013-12-17 23:00:27')
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 77ms (Views: 0.2ms | ActiveRecord: 0.5ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[35m (34.9ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:00:28', 'woop@tst.com', '2013-12-17 23:00:26', '2013-12-17 23:00:28')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:00:26 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:00:28', '2013-12-17 23:00:28')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:00:26 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:00:28', '2013-12-17 23:00:28')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 1.5ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:00:28', 'woop@tst.com', '2013-12-17 23:00:26', '2013-12-17 23:00:28')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '27845a7e-7acb-48c1-9386-3ec7fa113295', `updated_at` = '2013-12-17 23:00:28' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (71.7ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.0ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (206.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (116.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.9ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (121.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (131.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.6ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:00:42', '2013-12-17 23:00:42', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:00:42', '2013-12-17 23:00:42', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:00:42', '2013-12-17 23:00:42', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:00:42', '2013-12-17 23:00:42', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:00:42', '2013-12-17 23:00:42', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:00:42', '2013-12-17 23:00:42', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:00:42', '2013-12-17 23:00:42', 980190962)
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:00:42', '2013-12-17 23:00:42', 298486374)[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:00:42 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:00:43', 'tst@tst', '2013-12-17 23:00:42', '$2a$10$.W2xWmqdTFGV3HV9Q8otZOn.Z2XwzwEyzQ.jIGGShSp2Dghx1vf56', '$2a$10$.W2xWmqdTFGV3HV9Q8otZO', '2013-12-17 23:00:43')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 92ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:00:42 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:00:43', 'woop@tst.com', '2013-12-17 23:00:41', '$2a$10$Wfq.YQIaV0bNUhjJWff/suvP5WAny3znTn/YDy2OJ.eBIax.I0/U6', '$2a$10$Wfq.YQIaV0bNUhjJWff/su', '2013-12-17 23:00:43')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.5ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.7ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:00:43', 'woop@tst.com', '2013-12-17 23:00:41', '2013-12-17 23:00:43')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:00:41 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:00:43', '2013-12-17 23:00:43')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 0.8ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:00:41 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:00:43', '2013-12-17 23:00:43')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 3ms (Views: 0.1ms | ActiveRecord: 1.6ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:00:43', 'woop@tst.com', '2013-12-17 23:00:41', '2013-12-17 23:00:43')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  UPDATE `users` SET `confirmation_hash` = 'c1912a95-de09-4e71-950c-11fa2b33c108', `updated_at` = '2013-12-17 23:00:43' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (48.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (93.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (205.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (179.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:01:15', '2013-12-17 23:01:15', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:01:15', '2013-12-17 23:01:15', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:01:15', '2013-12-17 23:01:15', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:01:15', '2013-12-17 23:01:15', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:01:15', '2013-12-17 23:01:15', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:01:15', '2013-12-17 23:01:15', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:01:15', '2013-12-17 23:01:15', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:01:15', '2013-12-17 23:01:15', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:01:15 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:01:15', 'tst@tst', '2013-12-17 23:01:15', '$2a$10$MkIg47WEVLKlF3BCdU41gO3eXyUjDA9uJapAHF0F6dNybU.pQ05C2', '$2a$10$MkIg47WEVLKlF3BCdU41gO', '2013-12-17 23:01:15')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 89ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:01:15 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:01:15', 'woop@tst.com', '2013-12-17 23:01:14', '$2a$10$tutd3TLreQ13lYAq6ohVRuBpFZxcBFXoOlVRq7s3Pn9RPmDnf44ZK', '$2a$10$tutd3TLreQ13lYAq6ohVRu', '2013-12-17 23:01:15')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 0.5ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:01:16', 'woop@tst.com', '2013-12-17 23:01:14', '2013-12-17 23:01:16')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:01:14 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:01:16', '2013-12-17 23:01:16')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.0ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:01:14 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:01:16', '2013-12-17 23:01:16')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.1ms | ActiveRecord: 1.9ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:01:16', 'woop@tst.com', '2013-12-17 23:01:14', '2013-12-17 23:01:16')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '45094425-c83c-495f-8bf3-bb7d19f649c2', `updated_at` = '2013-12-17 23:01:16' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (15.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (1.1ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (102.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (196.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (133.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (130.9ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (139.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.7ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.8ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:01:59', '2013-12-17 23:01:59', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:01:59', '2013-12-17 23:01:59', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:01:59', '2013-12-17 23:01:59', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:01:59', '2013-12-17 23:01:59', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:01:59', '2013-12-17 23:01:59', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:01:59', '2013-12-17 23:01:59', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:01:59', '2013-12-17 23:01:59', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:01:59', '2013-12-17 23:01:59', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:01:59 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:01:59', 'tst@tst', '2013-12-17 23:01:59', '$2a$10$jd8PoVacocnpfgEipRRrcuboAgj0rzvtsqtAvE9/5Jt0rPT4rzi3W', '$2a$10$jd8PoVacocnpfgEipRRrcu', '2013-12-17 23:01:59')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 92ms (Views: 0.3ms | ActiveRecord: 1.8ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:01:59 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 2.2ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:01:59', 'woop@tst.com', '2013-12-17 23:01:58', '$2a$10$Y3aZRuH6flPrvd9SHckgz.yk87.R0wupmKADcKfObT2oGlhhFbtaS', '$2a$10$Y3aZRuH6flPrvd9SHckgz.', '2013-12-17 23:01:59')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (1.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:02:00', 'woop@tst.com', '2013-12-17 23:01:58', '2013-12-17 23:02:00')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:01:58 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:02:00', '2013-12-17 23:02:00')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 1.8ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:01:58 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:02:00', '2013-12-17 23:02:00')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 2.7ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:02:00', 'woop@tst.com', '2013-12-17 23:01:58', '2013-12-17 23:02:00')
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = 'd8751ce8-d099-4b46-9194-d96958c3ae49', `updated_at` = '2013-12-17 23:02:00' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (12.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (108.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (194.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (135.4ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (130.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (132.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:02:28', '2013-12-17 23:02:28', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:02:28', '2013-12-17 23:02:28', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:02:28', '2013-12-17 23:02:28', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:02:28', '2013-12-17 23:02:28', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:02:28', '2013-12-17 23:02:28', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:02:28', '2013-12-17 23:02:28', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.5ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:02:28', '2013-12-17 23:02:28', 980190962)
  [1m[36mFixture Insert (0.8ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:02:28', '2013-12-17 23:02:28', 298486374)[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:02:28 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:02:28', 'tst@tst', '2013-12-17 23:02:28', '$2a$10$Jsft5UVvTSVahkYBgznZl.AZ9pF4x29yuX0qE0/OuuCEZLeCmdBly', '$2a$10$Jsft5UVvTSVahkYBgznZl.', '2013-12-17 23:02:28')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 89ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:02:28 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:02:28', 'woop@tst.com', '2013-12-17 23:02:27', '$2a$10$J4xXyg7Ng.tqWm9ACZpkteroY9hNBRmwndpUOdxvPPM4KxSyDoWFK', '$2a$10$J4xXyg7Ng.tqWm9ACZpkte', '2013-12-17 23:02:28')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 78ms (Views: 0.3ms | ActiveRecord: 0.8ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:02:29', 'woop@tst.com', '2013-12-17 23:02:27', '2013-12-17 23:02:29')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:02:27 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.6ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:02:29', '2013-12-17 23:02:29')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.3ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:02:27 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.6ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965 AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:02:29', '2013-12-17 23:02:29')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.1ms | ActiveRecord: 2.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:02:29', 'woop@tst.com', '2013-12-17 23:02:27', '2013-12-17 23:02:29')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '9a99ebec-8347-4092-b033-55aabd893a30', `updated_at` = '2013-12-17 23:02:29' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (76.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (102.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (187.8ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (113.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (155.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (140.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (140.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.5ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.8ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.5ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.3ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:03:28', '2013-12-17 23:03:28', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:03:28', '2013-12-17 23:03:28', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:03:28', '2013-12-17 23:03:28', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:03:28', '2013-12-17 23:03:28', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:03:28', '2013-12-17 23:03:28', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:03:28', '2013-12-17 23:03:28', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:03:28', '2013-12-17 23:03:28', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:03:28', '2013-12-17 23:03:28', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:03:28 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.2ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:03:28', 'tst@tst', '2013-12-17 23:03:28', '$2a$10$UP/TK6V02gu5gQZ9OvzSVOX0CmxcV8BPcb8.rYaOIPtaE.h2oLfuC', '$2a$10$UP/TK6V02gu5gQZ9OvzSVO', '2013-12-17 23:03:28')[0m
  [1m[35m (0.7ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 90ms (Views: 0.4ms | ActiveRecord: 2.5ms)
  [1m[36mUser Load (0.7ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:03:28 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.5ms | ActiveRecord: 3.0ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:03:28', 'woop@tst.com', '2013-12-17 23:03:26', '$2a$10$VgZgcM9LsLGn4tZk5ymV4e4yeES/BYIfx40XSkoa6CwU0PyOIC6i2', '$2a$10$VgZgcM9LsLGn4tZk5ymV4e', '2013-12-17 23:03:28')
  [1m[36m (0.9ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 79ms (Views: 0.2ms | ActiveRecord: 0.7ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:03:28', 'woop@tst.com', '2013-12-17 23:03:26', '2013-12-17 23:03:28')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:03:26 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.7ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:03:28', '2013-12-17 23:03:28')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.0ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:03:26 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:03:28', '2013-12-17 23:03:28')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 8ms (Views: 0.2ms | ActiveRecord: 3.4ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:03:28', 'woop@tst.com', '2013-12-17 23:03:26', '2013-12-17 23:03:28')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '4f2eeccc-67d8-41f5-8127-5940a25a19e6', `updated_at` = '2013-12-17 23:03:28' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (44.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (93.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (197.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (130.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.2ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (140.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:03:52', '2013-12-17 23:03:52', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:03:52', '2013-12-17 23:03:52', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:03:52', '2013-12-17 23:03:52', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:03:52', '2013-12-17 23:03:52', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:03:52', '2013-12-17 23:03:52', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:03:52', '2013-12-17 23:03:52', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:03:52', '2013-12-17 23:03:52', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:03:52', '2013-12-17 23:03:52', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:03:52 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:03:52', 'tst@tst', '2013-12-17 23:03:52', '$2a$10$WxJdShSdh3sI5z4XWEKreeW66RYwhqRewhA41kprLwL2/ofWGHHWK', '$2a$10$WxJdShSdh3sI5z4XWEKree', '2013-12-17 23:03:52')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 90ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:03:52 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.3ms | ActiveRecord: 1.2ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:03:52', 'woop@tst.com', '2013-12-17 23:03:51', '$2a$10$GiyiwKS298juyzj7p2XWSOZBZi1m41rXyOblsQuUtKypuuaO.ZXnW', '$2a$10$GiyiwKS298juyzj7p2XWSO', '2013-12-17 23:03:52')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 74ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:03:53', 'woop@tst.com', '2013-12-17 23:03:51', '2013-12-17 23:03:53')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:03:51 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:03:53', '2013-12-17 23:03:53')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.0ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:03:51 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `updated_at`) VALUES ('2013-12-17 23:03:53', '2013-12-17 23:03:53')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.4ms | ActiveRecord: 2.1ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:03:53', 'woop@tst.com', '2013-12-17 23:03:51', '2013-12-17 23:03:53')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '99012916-6cc8-4246-93f9-950b206afa75', `updated_at` = '2013-12-17 23:03:53' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[36m (56.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (159.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (201.8ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (92.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (109.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (121.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (243.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.4ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.1ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:05:58', '2013-12-17 23:05:58', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:05:58', '2013-12-17 23:05:58', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:05:58', '2013-12-17 23:05:58', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:05:58', '2013-12-17 23:05:58', 298486374)[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:05:58', '2013-12-17 23:05:58', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:05:58', '2013-12-17 23:05:58', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:05:58', '2013-12-17 23:05:58', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:05:58', '2013-12-17 23:05:58', 298486374)[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:05:58 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:05:58', 'tst@tst', '2013-12-17 23:05:58', '$2a$10$3UobFUjMY/wvN6qpcf/emuEvX.8yrUk0FB1U0mvbn8nR1Q.3XMcSG', '$2a$10$3UobFUjMY/wvN6qpcf/emu', '2013-12-17 23:05:58')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 94ms (Views: 0.2ms | ActiveRecord: 1.2ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:05:58 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.6ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:05:58', 'woop@tst.com', '2013-12-17 23:05:57', '$2a$10$C2xVHtqTn7ln1H2oyV9vbOxbgm1A4lP.QOafHIxjsMA8.af9OFfE.', '$2a$10$C2xVHtqTn7ln1H2oyV9vbO', '2013-12-17 23:05:58')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.9ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 77ms (Views: 0.2ms | ActiveRecord: 0.9ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:05:59', 'woop@tst.com', '2013-12-17 23:05:57', '2013-12-17 23:05:59')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:05:57 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:05:59', '2014-12-17 23:05:59', '2013-12-17 23:05:59', '2013-12-17 23:05:59')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 21ms (Views: 0.2ms | ActiveRecord: 1.0ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:05:57 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.9ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:05:59', 'woop@tst.com', '2013-12-17 23:05:57', '2013-12-17 23:05:59')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '8de1603d-dbcd-4ce0-a1b3-f6c2e4ca0784', `updated_at` = '2013-12-17 23:05:59' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (70.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.9ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (91.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (167.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (96.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (129.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (134.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (142.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:07:14', '2013-12-17 23:07:14', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:07:14', '2013-12-17 23:07:14', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:07:14', '2013-12-17 23:07:14', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:07:14', '2013-12-17 23:07:14', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:07:14', '2013-12-17 23:07:14', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:07:14', '2013-12-17 23:07:14', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:07:14', '2013-12-17 23:07:14', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:07:14', '2013-12-17 23:07:14', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:07:14 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:07:15', 'tst@tst', '2013-12-17 23:07:14', '$2a$10$np/r51gQz96KBrBQJYRTiODE3dUGWThZ59JrduGkhGKbPYjEhaI0W', '$2a$10$np/r51gQz96KBrBQJYRTiO', '2013-12-17 23:07:15')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 100ms (Views: 0.3ms | ActiveRecord: 1.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:07:14 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 2.2ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:07:15', 'woop@tst.com', '2013-12-17 23:07:13', '$2a$10$T7qX6CaIQREUI.RHBpE8m.La6EDEt/TDpFrDmvQ2LqrJ4BF3Ktxd6', '$2a$10$T7qX6CaIQREUI.RHBpE8m.', '2013-12-17 23:07:15')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.8ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 77ms (Views: 0.3ms | ActiveRecord: 0.8ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:07:15', 'woop@tst.com', '2013-12-17 23:07:13', '2013-12-17 23:07:15')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:07:13 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:07:15', '2014-12-17 23:07:15', '2013-12-17 23:07:15', '2013-12-17 23:07:15')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.9ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:07:13 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 1.4ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:07:15', 'woop@tst.com', '2013-12-17 23:07:13', '2013-12-17 23:07:15')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = 'ef4cc876-6aac-47af-942d-4aaf073f0c47', `updated_at` = '2013-12-17 23:07:15' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (60.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (91.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (261.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (105.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (130.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (156.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:08:54', '2013-12-17 23:08:54', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:08:54', '2013-12-17 23:08:54', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.9ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:08:54', '2013-12-17 23:08:54', 980190962)
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:08:54', '2013-12-17 23:08:54', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:08:54', '2013-12-17 23:08:54', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:08:54', '2013-12-17 23:08:54', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:08:54', '2013-12-17 23:08:54', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:08:54', '2013-12-17 23:08:54', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:08:54 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:08:54', 'tst@tst', '2013-12-17 23:08:54', '$2a$10$YLbM/nUIsh/..VwYNjMYz.smQDX5Ry6RoW6eKAtCs5pdnNplTGRFm', '$2a$10$YLbM/nUIsh/..VwYNjMYz.', '2013-12-17 23:08:54')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 91ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:08:54 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:08:54', 'woop@tst.com', '2013-12-17 23:08:53', '$2a$10$FCNBKwNXgOz5SKRHkZMCKOnYnUyE7C2pYlQX6BmWiW0P8XTCKhA86', '$2a$10$FCNBKwNXgOz5SKRHkZMCKO', '2013-12-17 23:08:54')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 77ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 77ms (Views: 0.3ms | ActiveRecord: 0.8ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:08:54', 'woop@tst.com', '2013-12-17 23:08:53', '2013-12-17 23:08:54')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:08:53 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.6ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:08:54', '2014-12-17 23:08:54', '2013-12-17 23:08:54', '2013-12-17 23:08:54')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 9ms (Views: 0.8ms | ActiveRecord: 2.0ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:08:53 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.5ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 8ms (Views: 1.3ms | ActiveRecord: 3.2ms)
  [1m[35m (1.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:08:54', 'woop@tst.com', '2013-12-17 23:08:53', '2013-12-17 23:08:54')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '51603908-1aca-48fc-8599-2eb278a5a848', `updated_at` = '2013-12-17 23:08:54' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (62.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (89.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (187.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (120.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (114.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.8ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (1.4ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.8ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:09:23', '2013-12-17 23:09:23', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:09:23', '2013-12-17 23:09:23', 298486374)
  [1m[36mFixture Delete (0.6ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:09:23', '2013-12-17 23:09:23', 980190962)
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:09:23', '2013-12-17 23:09:23', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:09:23', '2013-12-17 23:09:23', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:09:23', '2013-12-17 23:09:23', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:09:23', '2013-12-17 23:09:23', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:09:23', '2013-12-17 23:09:23', 298486374)[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:09:23 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:09:23', 'tst@tst', '2013-12-17 23:09:23', '$2a$10$j.Zqg19sCZCy8bWw7T3eYeVMCPRbfgsR7yus.OV5OgX3t80fRiwSW', '$2a$10$j.Zqg19sCZCy8bWw7T3eYe', '2013-12-17 23:09:23')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 85ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:09:23 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.4ms | ActiveRecord: 1.4ms)
  [1m[36m (0.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:09:23', 'woop@tst.com', '2013-12-17 23:09:22', '$2a$10$LeCoV4G4TS2vbZgV0OHok.zf5v9lobEElx2tpYrFtIrpUb0d2I7RC', '$2a$10$LeCoV4G4TS2vbZgV0OHok.', '2013-12-17 23:09:23')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 73ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:09:23', 'woop@tst.com', '2013-12-17 23:09:22', '2013-12-17 23:09:23')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:09:22 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:09:23', '2014-12-17 23:09:23', '2013-12-17 23:09:23', '2013-12-17 23:09:23')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.8ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:09:22 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 1.9ms)
  [1m[35m (1.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:09:23', 'woop@tst.com', '2013-12-17 23:09:22', '2013-12-17 23:09:23')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '22d99105-8d0c-4fb0-9b1b-eb2544d7e0dd', `updated_at` = '2013-12-17 23:09:23' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 9ms (Views: 0.7ms | ActiveRecord: 2.0ms)
  [1m[36mUser Load (0.9ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (68.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (99.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (186.3ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (88.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (120.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (143.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (1.1ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.9ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (1.1ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:10:25', '2013-12-17 23:10:25', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:10:25', '2013-12-17 23:10:25', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:10:25', '2013-12-17 23:10:25', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:10:25', '2013-12-17 23:10:25', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:10:25', '2013-12-17 23:10:25', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:10:25', '2013-12-17 23:10:25', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:10:25', '2013-12-17 23:10:25', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:10:25', '2013-12-17 23:10:25', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:10:25 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:10:25', 'tst@tst', '2013-12-17 23:10:25', '$2a$10$Dkp1CpWdwIm6J1m3Qq1lauNVyAE0P.c8VF5KgUr755pzkW5kjzkXG', '$2a$10$Dkp1CpWdwIm6J1m3Qq1lau', '2013-12-17 23:10:25')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 91ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:10:25 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.7ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:10:26', 'woop@tst.com', '2013-12-17 23:10:24', '$2a$10$RknupkRSTC3lY9sb90.Udu4PedODn9TBv8XEsMRtxYjpfO0S3noMW', '$2a$10$RknupkRSTC3lY9sb90.Udu', '2013-12-17 23:10:26')
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.8ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:10:26', 'woop@tst.com', '2013-12-17 23:10:24', '2013-12-17 23:10:26')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:10:24 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:10:26', '2014-12-17 23:10:26', '2013-12-17 23:10:26', '2013-12-17 23:10:26')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.8ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:10:24 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 1.5ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:10:26', 'woop@tst.com', '2013-12-17 23:10:24', '2013-12-17 23:10:26')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = 'af88b52f-4561-484e-b96c-e71030fe6648', `updated_at` = '2013-12-17 23:10:26' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (49.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (144.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (213.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (97.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (134.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (148.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.3ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:11:12', '2013-12-17 23:11:12', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:11:12', '2013-12-17 23:11:12', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.5ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:11:12', '2013-12-17 23:11:12', 980190962)
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:11:12', '2013-12-17 23:11:12', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:11:12', '2013-12-17 23:11:12', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:11:12', '2013-12-17 23:11:12', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:11:12', '2013-12-17 23:11:12', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:11:12', '2013-12-17 23:11:12', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:11:12 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:11:12', 'tst@tst', '2013-12-17 23:11:12', '$2a$10$rXp9nX8vt2RzpSaxBKQjDeJGRrEod3/KaTEwLmmManODpEpqEfxXa', '$2a$10$rXp9nX8vt2RzpSaxBKQjDe', '2013-12-17 23:11:12')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 96ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:11:12 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.6ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:11:12', 'woop@tst.com', '2013-12-17 23:11:11', '$2a$10$.iWva3hGQWvmYF1oqcehReT1tA164BrrE3bijgDruZGdrALuaNkDq', '$2a$10$.iWva3hGQWvmYF1oqcehRe', '2013-12-17 23:11:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 78ms (Views: 0.3ms | ActiveRecord: 0.5ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.9ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:11:12', 'woop@tst.com', '2013-12-17 23:11:11', '2013-12-17 23:11:12')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:11:11 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:11:12', '2014-12-17 23:11:12', '2013-12-17 23:11:12', '2013-12-17 23:11:12')[0m
  [1m[35m (0.5ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 11ms (Views: 0.5ms | ActiveRecord: 1.7ms)
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:11:11 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 2.3ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
  [1m[36m (67.7ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:11:12', 'woop@tst.com', '2013-12-17 23:11:11', '2013-12-17 23:11:12')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '71490610-1099-4dd6-9ddb-d244cf794a13', `updated_at` = '2013-12-17 23:11:12' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (56.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (38.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.9ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (114.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (260.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (114.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (230.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (399.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:11:44', '2013-12-17 23:11:44', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:11:44', '2013-12-17 23:11:44', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:11:44', '2013-12-17 23:11:44', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:11:44', '2013-12-17 23:11:44', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:11:44', '2013-12-17 23:11:44', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:11:44', '2013-12-17 23:11:44', 298486374)
  [1m[36mFixture Delete (0.9ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:11:44', '2013-12-17 23:11:44', 980190962)
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:11:44', '2013-12-17 23:11:44', 298486374)[0m
  [1m[35m (1.5ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:11:44 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:11:44', 'tst@tst', '2013-12-17 23:11:44', '$2a$10$EzlE0bUm0/2R8L7cOCNGc.exA8fXpOTIrrHzSHGzMV8pTiAIUm1P.', '$2a$10$EzlE0bUm0/2R8L7cOCNGc.', '2013-12-17 23:11:44')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 87ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:11:44 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:11:44', 'woop@tst.com', '2013-12-17 23:11:42', '$2a$10$iSX40ikrsbEECuOusAt3JeB0GN50Tc6elpbXinevMd5SA1Uokah6a', '$2a$10$iSX40ikrsbEECuOusAt3Je', '2013-12-17 23:11:44')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 79ms (Views: 0.9ms | ActiveRecord: 0.7ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:11:44', 'woop@tst.com', '2013-12-17 23:11:42', '2013-12-17 23:11:44')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:11:42 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:11:44', '2014-12-17 23:11:44', '2013-12-17 23:11:44', '2013-12-17 23:11:44')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 1.1ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:11:44', 'woop@tst.com', '2013-12-17 23:11:42', '2013-12-17 23:11:44')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = 'db687e99-a452-45a8-b012-df31f66ffbab', `updated_at` = '2013-12-17 23:11:44' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36mUser Load (0.7ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (78.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (69.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (163.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (103.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (130.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (132.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (143.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.8ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.5ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.5ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.4ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:12:25', '2013-12-17 23:12:25', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:12:25', '2013-12-17 23:12:25', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:12:25', '2013-12-17 23:12:25', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:12:25', '2013-12-17 23:12:25', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:12:25', '2013-12-17 23:12:25', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:12:25', '2013-12-17 23:12:25', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:12:25', '2013-12-17 23:12:25', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:12:25', '2013-12-17 23:12:25', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:12:26 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:12:26', 'tst@tst', '2013-12-17 23:12:26', '$2a$10$5DvdO4X8x8uphSiu.7XLN.SMmIQWauefBTrv6me6HS9l9vjry1Dq.', '$2a$10$5DvdO4X8x8uphSiu.7XLN.', '2013-12-17 23:12:26')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 92ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[36mUser Load (0.8ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:12:26 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.8ms)
  [1m[36m (1.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:12:26', 'woop@tst.com', '2013-12-17 23:12:24', '$2a$10$w5ZjUFxJHdLQOoS8.vDHQuI.7JCgBky605XsOFddP8dQSLGC59BTe', '$2a$10$w5ZjUFxJHdLQOoS8.vDHQu', '2013-12-17 23:12:26')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 73ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:12:26', 'woop@tst.com', '2013-12-17 23:12:24', '2013-12-17 23:12:26')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:12:24 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.8ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:12:26', '2014-12-17 23:12:26', '2013-12-17 23:12:26', '2013-12-17 23:12:26')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 10ms (Views: 0.7ms | ActiveRecord: 1.5ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:12:24 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 2.2ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:12:26', 'woop@tst.com', '2013-12-17 23:12:24', '2013-12-17 23:12:26')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '052984d9-3d35-40fa-a77a-8eeeb7a90751', `updated_at` = '2013-12-17 23:12:26' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (59.6ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (102.5ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (187.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (90.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (122.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (129.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (1.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:12:56', '2013-12-17 23:12:56', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:12:56', '2013-12-17 23:12:56', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:12:56', '2013-12-17 23:12:56', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:12:56', '2013-12-17 23:12:56', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.8ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:12:56', '2013-12-17 23:12:56', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:12:56', '2013-12-17 23:12:56', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.8ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:12:56', '2013-12-17 23:12:56', 980190962)
  [1m[36mFixture Insert (0.8ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:12:56', '2013-12-17 23:12:56', 298486374)[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:12:56 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:12:57', 'tst@tst', '2013-12-17 23:12:56', '$2a$10$vDspwarTJqdwI3Yu1nTUQuNEGGbcWSvYI0n1NZq8cE9DzWNUtf9cm', '$2a$10$vDspwarTJqdwI3Yu1nTUQu', '2013-12-17 23:12:57')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 85ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:12:56 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:12:57', 'woop@tst.com', '2013-12-17 23:12:55', '$2a$10$66zs8OIbJ7Xwd2nt6StOBup6Bi4p05LZeco0aGns2oOhqJPolsFn2', '$2a$10$66zs8OIbJ7Xwd2nt6StOBu', '2013-12-17 23:12:57')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:12:57', 'woop@tst.com', '2013-12-17 23:12:55', '2013-12-17 23:12:57')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:12:55 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:12:57', '2014-12-17 23:12:57', '2013-12-17 23:12:57', '2013-12-17 23:12:57')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.7ms | ActiveRecord: 1.1ms)
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:12:55 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 1.6ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:12:57', 'woop@tst.com', '2013-12-17 23:12:55', '2013-12-17 23:12:57')
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.1ms)[0m  UPDATE `users` SET `confirmation_hash` = '1ffc9e70-7469-4016-87aa-e5cf1961cf6b', `updated_at` = '2013-12-17 23:12:57' WHERE `users`.`id` = 980190966
  [1m[36m (0.5ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.3ms | ActiveRecord: 2.1ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (48.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (84.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (150.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (94.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (122.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (131.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:13:17', '2013-12-17 23:13:17', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:13:17', '2013-12-17 23:13:17', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:13:17', '2013-12-17 23:13:17', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:13:17', '2013-12-17 23:13:17', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:13:17', '2013-12-17 23:13:17', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:13:17', '2013-12-17 23:13:17', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:13:17', '2013-12-17 23:13:17', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:13:17', '2013-12-17 23:13:17', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:13:17 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:13:17', 'tst@tst', '2013-12-17 23:13:17', '$2a$10$t5Nrcgfd1H5ByU3t1pvA4.rimnd5oIMVYIeucrj.5ML41lw4J0oBG', '$2a$10$t5Nrcgfd1H5ByU3t1pvA4.', '2013-12-17 23:13:17')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 90ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:13:17 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:13:17', 'woop@tst.com', '2013-12-17 23:13:16', '$2a$10$5ZEIfOlU2GyTJZ75xk2vWO.b7aEYh2TxQyiMCke0b7VppImnMPtQC', '$2a$10$5ZEIfOlU2GyTJZ75xk2vWO', '2013-12-17 23:13:17')
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.2ms | ActiveRecord: 0.5ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:13:17', 'woop@tst.com', '2013-12-17 23:13:16', '2013-12-17 23:13:17')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:13:16 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:13:17', '2014-12-17 23:13:17', '2013-12-17 23:13:17', '2013-12-17 23:13:17')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 8ms (Views: 0.9ms | ActiveRecord: 1.1ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:13:16 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.7ms | ActiveRecord: 1.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:13:17', 'woop@tst.com', '2013-12-17 23:13:16', '2013-12-17 23:13:17')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '77c77bec-2195-4c2f-986d-5fa34a2018fd', `updated_at` = '2013-12-17 23:13:17' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (59.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (95.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (221.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (99.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (130.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (132.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (141.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.9ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:14:07', '2013-12-17 23:14:07', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:14:07', '2013-12-17 23:14:07', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:14:07', '2013-12-17 23:14:07', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:14:07', '2013-12-17 23:14:07', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:14:07', '2013-12-17 23:14:07', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:14:07', '2013-12-17 23:14:07', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:14:07', '2013-12-17 23:14:07', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:14:07', '2013-12-17 23:14:07', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:14:07 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:14:07', 'tst@tst', '2013-12-17 23:14:07', '$2a$10$prXfW86WcV2yep581CM7Pen0oqHhMzx8ug9D4ZDf5VeIQaFj91.7.', '$2a$10$prXfW86WcV2yep581CM7Pe', '2013-12-17 23:14:07')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 87ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:14:07 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.3ms | ActiveRecord: 1.2ms)
  [1m[36m (1.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:14:08', 'woop@tst.com', '2013-12-17 23:14:06', '$2a$10$NH03KAtySU51w2OOzFCpYOd7l2anlPsPKnEMw.yLqDnL9Ytr.I6zO', '$2a$10$NH03KAtySU51w2OOzFCpYO', '2013-12-17 23:14:08')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.2ms | ActiveRecord: 0.6ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:14:08', 'woop@tst.com', '2013-12-17 23:14:06', '2013-12-17 23:14:08')[0m
  [1m[35m (0.6ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:14:06 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.8ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:14:08', '2014-12-17 23:14:08', '2013-12-17 23:14:08', '2013-12-17 23:14:08')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 12ms (Views: 0.5ms | ActiveRecord: 2.0ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:14:06 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.7ms | ActiveRecord: 2.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:14:08', 'woop@tst.com', '2013-12-17 23:14:06', '2013-12-17 23:14:08')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '77dda285-1127-4ea1-9efb-9a6c1560bfa8', `updated_at` = '2013-12-17 23:14:08' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (67.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.9ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (102.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (187.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (91.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (134.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (122.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:15:06', '2013-12-17 23:15:06', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:15:06', '2013-12-17 23:15:06', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:15:06', '2013-12-17 23:15:06', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:15:06', '2013-12-17 23:15:06', 298486374)[0m
  [1m[35mFixture Delete (0.7ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:15:06', '2013-12-17 23:15:06', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:15:06', '2013-12-17 23:15:06', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:15:06', '2013-12-17 23:15:06', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:15:06', '2013-12-17 23:15:06', 298486374)[0m
  [1m[35m (0.3ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:15:06 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:15:06', 'tst@tst', '2013-12-17 23:15:06', '$2a$10$CpWWeU4DH3.47FjIANWzluVe1Z8z1WQ3aiE7bPee5sroFsnV4vbdC', '$2a$10$CpWWeU4DH3.47FjIANWzlu', '2013-12-17 23:15:06')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 87ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:15:06 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:15:06', 'woop@tst.com', '2013-12-17 23:15:05', '$2a$10$9wXrk3B63Rs43cbOkDH6F.//ysVTo22IXBiBbqGeImoCZDP4P2ujG', '$2a$10$9wXrk3B63Rs43cbOkDH6F.', '2013-12-17 23:15:06')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.8ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 0.8ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 1.2ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:15:06', 'woop@tst.com', '2013-12-17 23:15:05', '2013-12-17 23:15:06')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:15:05 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:15:06', '2014-12-17 23:15:06', '2013-12-17 23:15:06', '2013-12-17 23:15:06')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.9ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:15:05 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:15:06', `updated_at` = '2013-12-17 23:15:06' WHERE `subscriptions`.`id` = 980190963
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 1.9ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:15:06', 'woop@tst.com', '2013-12-17 23:15:05', '2013-12-17 23:15:06')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = 'f91cdc18-c050-408e-8a71-8e47015f7bcc', `updated_at` = '2013-12-17 23:15:06' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (50.3ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (1.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (123.4ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (202.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (105.7ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (134.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (143.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (135.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (1.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:15:27', '2013-12-17 23:15:27', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:15:27', '2013-12-17 23:15:27', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:15:27', '2013-12-17 23:15:27', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:15:27', '2013-12-17 23:15:27', 298486374)[0m
  [1m[35mFixture Delete (0.7ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:15:27', '2013-12-17 23:15:27', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:15:27', '2013-12-17 23:15:27', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:15:27', '2013-12-17 23:15:27', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:15:27', '2013-12-17 23:15:27', 298486374)[0m
  [1m[35m (1.0ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:15:27 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.8ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:15:27', 'tst@tst', '2013-12-17 23:15:27', '$2a$10$wfwCdZ/x0d/Ga2fzdTqSiO9r/1BTVxXCzhw96TkwuC/nK/x2wRsSC', '$2a$10$wfwCdZ/x0d/Ga2fzdTqSiO', '2013-12-17 23:15:27')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 88ms (Views: 0.3ms | ActiveRecord: 1.5ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:15:27 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.8ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:15:27', 'woop@tst.com', '2013-12-17 23:15:26', '$2a$10$XQ.aNAEHpwnMAujLDc.YmukwPTs8k3r8CJ//E9SH5EP3sP6/f2u6q', '$2a$10$XQ.aNAEHpwnMAujLDc.Ymu', '2013-12-17 23:15:27')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 78ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.4ms | ActiveRecord: 0.8ms)
  [1m[35m (1.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.7ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:15:27', 'woop@tst.com', '2013-12-17 23:15:26', '2013-12-17 23:15:27')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:15:26 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.5ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:15:27', '2014-12-17 23:15:27', '2013-12-17 23:15:27', '2013-12-17 23:15:27')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 1.1ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:15:26 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:15:27', `updated_at` = '2013-12-17 23:15:27' WHERE `subscriptions`.`id` = 980190963
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 1.2ms | ActiveRecord: 2.7ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:15:27', 'woop@tst.com', '2013-12-17 23:15:26', '2013-12-17 23:15:27')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '18eb3146-fcd0-46b3-9d99-a15102175a5b', `updated_at` = '2013-12-17 23:15:27' WHERE `users`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (64.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (102.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (200.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (114.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (117.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (123.2ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.7ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.6ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.4ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:15:51', '2013-12-17 23:15:51', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:15:51', '2013-12-17 23:15:51', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:15:51', '2013-12-17 23:15:51', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:15:51', '2013-12-17 23:15:51', 298486374)[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:15:51', '2013-12-17 23:15:51', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:15:51', '2013-12-17 23:15:51', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.8ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:15:51', '2013-12-17 23:15:51', 980190962)
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:15:51', '2013-12-17 23:15:51', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.7ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:15:51 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:15:51', 'tst@tst', '2013-12-17 23:15:51', '$2a$10$9QdEju98789qhOjpbDB32edz8sVUe8y.Orr6ZCE9MVDc9vkJgP1KS', '$2a$10$9QdEju98789qhOjpbDB32e', '2013-12-17 23:15:51')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 92ms (Views: 0.4ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:15:51 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:15:51', 'woop@tst.com', '2013-12-17 23:15:50', '$2a$10$6yK2mg93c3V08j7I.qxM5uA4DD2IbboFq.WrS2NcittpohtN1q7Zu', '$2a$10$6yK2mg93c3V08j7I.qxM5u', '2013-12-17 23:15:51')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.3ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:15:52', 'woop@tst.com', '2013-12-17 23:15:50', '2013-12-17 23:15:52')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:15:50 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:15:52', '2014-12-17 23:15:52', '2013-12-17 23:15:52', '2013-12-17 23:15:52')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.8ms | ActiveRecord: 1.0ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:15:50 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.7ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.9ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:15:52', `updated_at` = '2013-12-17 23:15:52' WHERE `subscriptions`.`id` = 980190963[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 9ms (Views: 0.8ms | ActiveRecord: 3.0ms)
  [1m[36m (1.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:15:52', 'woop@tst.com', '2013-12-17 23:15:50', '2013-12-17 23:15:52')
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '6812b1a9-fbd8-4e1d-86aa-06c7ae04633b', `updated_at` = '2013-12-17 23:15:52' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (41.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (137.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (242.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (112.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (145.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (155.5ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.8ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:16:19', '2013-12-17 23:16:19', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:16:19', '2013-12-17 23:16:19', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:16:19', '2013-12-17 23:16:19', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:16:19', '2013-12-17 23:16:19', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:16:19', '2013-12-17 23:16:19', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:16:19', '2013-12-17 23:16:19', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:16:19', '2013-12-17 23:16:19', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:16:19', '2013-12-17 23:16:19', 298486374)[0m
  [1m[35m (0.4ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:16:19 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:16:19', 'tst@tst', '2013-12-17 23:16:19', '$2a$10$gdOfhpRUnLLbXrOY.nKv0.fQ3BNbV/61rocCZFrOr9cXj9q2g5UbS', '$2a$10$gdOfhpRUnLLbXrOY.nKv0.', '2013-12-17 23:16:19')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 93ms (Views: 0.2ms | ActiveRecord: 1.3ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:16:19 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.9ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 5ms (Views: 0.2ms | ActiveRecord: 2.2ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:16:19', 'woop@tst.com', '2013-12-17 23:16:18', '$2a$10$n4COx89FhA6K7KwfhS1eLOfQB3lSEIqUnofF1ObaNU0b0NeTzg2y2', '$2a$10$n4COx89FhA6K7KwfhS1eLO', '2013-12-17 23:16:19')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 77ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 78ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:16:20', 'woop@tst.com', '2013-12-17 23:16:18', '2013-12-17 23:16:20')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:16:18 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:16:20', '2014-12-17 23:16:20', '2013-12-17 23:16:20', '2013-12-17 23:16:20')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 1.2ms | ActiveRecord: 0.8ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190965", "start_date"=>"2013-12-17 23:16:18 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190965"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:16:20', `updated_at` = '2013-12-17 23:16:20' WHERE `subscriptions`.`id` = 980190963
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 1.1ms | ActiveRecord: 1.9ms)
  [1m[35mSubscription Load (0.6ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
  [1m[36m (0.8ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:16:20', 'woop@tst.com', '2013-12-17 23:16:18', '2013-12-17 23:16:20')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.8ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '5cbdbfa8-286d-446a-b0df-9e34f61e7fa1', `updated_at` = '2013-12-17 23:16:20' WHERE `users`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (49.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (97.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (200.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (97.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (135.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (127.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (139.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.6ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:20:25', '2013-12-17 23:20:25', 980190962)[0m
  [1m[35mFixture Insert (0.6ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:20:25', '2013-12-17 23:20:25', 298486374)
  [1m[36mFixture Delete (0.8ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:20:25', '2013-12-17 23:20:25', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:20:25', '2013-12-17 23:20:25', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:20:25', '2013-12-17 23:20:25', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:20:25', '2013-12-17 23:20:25', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:20:25', '2013-12-17 23:20:25', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:20:25', '2013-12-17 23:20:25', 298486374)[0m
  [1m[35m (1.1ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.3ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:20:25 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:20:25', 'tst@tst', '2013-12-17 23:20:25', '$2a$10$gKfLWLJCIyQRUtpWFTSLGOgXrjdBOHMyKoMLHGF53nYTpF39cuR0q', '$2a$10$gKfLWLJCIyQRUtpWFTSLGO', '2013-12-17 23:20:25')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 93ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:20:25 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (1.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.2ms | ActiveRecord: 2.6ms)
  [1m[36m (1.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:20:25', 'woop@tst.com', '2013-12-17 23:20:24', '2013-12-17 23:20:25')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
Completed 200 OK in 1ms (Views: 0.7ms | ActiveRecord: 0.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:20:25', 'woop@tst.com', '2013-12-17 23:20:24', '$2a$10$/0Vrx.YwFx.75iqyVfVAwOAwOxt/WO6lrJyKcn00uBUHiYCgvWUwS', '$2a$10$/0Vrx.YwFx.75iqyVfVAwO', '2013-12-17 23:20:25')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 79ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 75ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:20:26', 'woop@tst.com', '2013-12-17 23:20:24', '2013-12-17 23:20:26')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:20:24 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:20:26', '2014-12-17 23:20:26', '2013-12-17 23:20:26', '2013-12-17 23:20:26')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.5ms | ActiveRecord: 0.8ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:20:24 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:20:26', `updated_at` = '2013-12-17 23:20:26' WHERE `subscriptions`.`id` = 980190963
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 1.7ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:20:26', 'woop@tst.com', '2013-12-17 23:20:24', '2013-12-17 23:20:26')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '47cedc8c-b178-4b49-b48b-b6aa32e4bfcc', `updated_at` = '2013-12-17 23:20:26' WHERE `users`.`id` = 980190967
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (68.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (101.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (174.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (118.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (127.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (146.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.9ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:20:55', '2013-12-17 23:20:55', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:20:55', '2013-12-17 23:20:55', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:20:55', '2013-12-17 23:20:55', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:20:55', '2013-12-17 23:20:55', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:20:55', '2013-12-17 23:20:55', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:20:55', '2013-12-17 23:20:55', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:20:55', '2013-12-17 23:20:55', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:20:55', '2013-12-17 23:20:55', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:20:55 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.8ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:20:55', 'tst@tst', '2013-12-17 23:20:55', '$2a$10$keoWwHmA2GqUBf85vDCbguBYLOL9uwYfpL/K5BGq.cl20F7yB.TPW', '$2a$10$keoWwHmA2GqUBf85vDCbgu', '2013-12-17 23:20:55')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 96ms (Views: 0.3ms | ActiveRecord: 1.7ms)
  [1m[36mUser Load (1.0ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:20:55 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 2.1ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:20:55', 'woop@tst.com', '2013-12-17 23:20:54', '2013-12-17 23:20:55')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35m (17.9ms)[0m  SELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
Completed 200 OK in 20ms (Views: 0.7ms | ActiveRecord: 18.3ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:20:55', 'woop@tst.com', '2013-12-17 23:20:54', '$2a$10$DR2kQ541a5/0yI7Qhd3R1.Y6l0voGWMlvlQQ0aHSC6KJ9AsvsuSAC', '$2a$10$DR2kQ541a5/0yI7Qhd3R1.', '2013-12-17 23:20:55')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 76ms (Views: 0.4ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 76ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:20:55', 'woop@tst.com', '2013-12-17 23:20:54', '2013-12-17 23:20:55')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:20:54 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:20:55', '2014-12-17 23:20:55', '2013-12-17 23:20:55', '2013-12-17 23:20:55')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.6ms | ActiveRecord: 1.0ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:20:54 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (1.1ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:20:55', `updated_at` = '2013-12-17 23:20:55' WHERE `subscriptions`.`id` = 980190963[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.4ms | ActiveRecord: 2.6ms)
  [1m[36mSubscription Load (0.2ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:20:55', 'woop@tst.com', '2013-12-17 23:20:54', '2013-12-17 23:20:55')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = 'd710721f-83e5-4923-b3e0-913ac088aff8', `updated_at` = '2013-12-17 23:20:55' WHERE `users`.`id` = 980190967[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.6ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (277.9ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.9ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (278.7ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (141.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (115.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (107.3ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (117.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (140.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.8ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (1.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.6ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:21:19', '2013-12-17 23:21:19', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:21:19', '2013-12-17 23:21:19', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:21:19', '2013-12-17 23:21:19', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:21:19', '2013-12-17 23:21:19', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:21:19', '2013-12-17 23:21:19', 980190962)[0m
  [1m[35mFixture Insert (1.0ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:21:19', '2013-12-17 23:21:19', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:21:19', '2013-12-17 23:21:19', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:21:19', '2013-12-17 23:21:19', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:21:19 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:21:19', 'tst@tst', '2013-12-17 23:21:19', '$2a$10$0oJM7VwKm8rX/pMuoncXHeRFoPhZsUAAFeP81hh../N6HUizV6UoK', '$2a$10$0oJM7VwKm8rX/pMuoncXHe', '2013-12-17 23:21:19')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 84ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:21:19 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:19', 'woop@tst.com', '2013-12-17 23:21:18', '2013-12-17 23:21:19')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
  [1m[36mSubscription Load (0.2ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.5ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:21:20', 'woop@tst.com', '2013-12-17 23:21:18', '$2a$10$8qGPzlg75ILs40.VF.hVz.Elv3pPjd/augr6AD4X.ZYS4ni/Rrkt.', '$2a$10$8qGPzlg75ILs40.VF.hVz.', '2013-12-17 23:21:20')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 77ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 75ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:20', 'woop@tst.com', '2013-12-17 23:21:18', '2013-12-17 23:21:20')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:21:18 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:21:20', '2014-12-17 23:21:20', '2013-12-17 23:21:20', '2013-12-17 23:21:20')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.8ms)
  [1m[35mSubscription Load (0.7ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:21:18 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:21:20', `updated_at` = '2013-12-17 23:21:20' WHERE `subscriptions`.`id` = 980190963[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 8ms (Views: 0.8ms | ActiveRecord: 2.7ms)
  [1m[36mSubscription Load (0.5ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:20', 'woop@tst.com', '2013-12-17 23:21:18', '2013-12-17 23:21:20')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '8458f5ec-b31b-44ee-acc6-0a13350ee7a6', `updated_at` = '2013-12-17 23:21:20' WHERE `users`.`id` = 980190967[0m
  [1m[35m (0.5ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 1.7ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (11.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (158.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (216.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (117.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (123.1ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (116.4ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.5ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.4ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:21:35', '2013-12-17 23:21:35', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:21:35', '2013-12-17 23:21:35', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:21:35', '2013-12-17 23:21:35', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:21:35', '2013-12-17 23:21:35', 298486374)[0m
  [1m[35mFixture Delete (0.6ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:21:35', '2013-12-17 23:21:35', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:21:35', '2013-12-17 23:21:35', 298486374)
  [1m[36mFixture Delete (0.5ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.7ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:21:35', '2013-12-17 23:21:35', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:21:35', '2013-12-17 23:21:35', 298486374)[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:21:35 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:21:35', 'tst@tst', '2013-12-17 23:21:35', '$2a$10$5m3KyMPtoNB7z.E5zNN2Uu.sDvGj.UB3CpI4P0kSgC9VPbgnHqlDq', '$2a$10$5m3KyMPtoNB7z.E5zNN2Uu', '2013-12-17 23:21:35')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 88ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:21:35 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:35', 'woop@tst.com', '2013-12-17 23:21:34', '2013-12-17 23:21:35')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
  [1m[36mSubscription Load (0.2ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.5ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:21:36', 'woop@tst.com', '2013-12-17 23:21:34', '$2a$10$6hzoMHRF/e/MccTIRL26E.MgDqDhZloToCRGweAEc5jMvhfIlxP2.', '$2a$10$6hzoMHRF/e/MccTIRL26E.', '2013-12-17 23:21:36')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 76ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 74ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:36', 'woop@tst.com', '2013-12-17 23:21:34', '2013-12-17 23:21:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:21:34 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.5ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:21:36', '2014-12-17 23:21:36', '2013-12-17 23:21:36', '2013-12-17 23:21:36')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.6ms | ActiveRecord: 1.2ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:21:34 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (1.0ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:21:36', `updated_at` = '2013-12-17 23:21:36' WHERE `subscriptions`.`id` = 980190963[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 2.7ms)
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:36', 'woop@tst.com', '2013-12-17 23:21:34', '2013-12-17 23:21:36')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '4c8c76f4-a307-416b-85a4-ab1616e73d75', `updated_at` = '2013-12-17 23:21:36' WHERE `users`.`id` = 980190967[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (74.0ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.8ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (91.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (178.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (87.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (122.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (120.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (128.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.5ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:21:54', '2013-12-17 23:21:54', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:21:54', '2013-12-17 23:21:54', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:21:54', '2013-12-17 23:21:54', 980190962)
  [1m[36mFixture Insert (0.4ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:21:54', '2013-12-17 23:21:54', 298486374)[0m
  [1m[35mFixture Delete (0.5ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:21:54', '2013-12-17 23:21:54', 980190962)[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:21:54', '2013-12-17 23:21:54', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:21:55', '2013-12-17 23:21:55', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:21:55', '2013-12-17 23:21:55', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:21:55 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:21:55', 'tst@tst', '2013-12-17 23:21:55', '$2a$10$JoaOwHCxtF1FGR3YbRMn0uOlIGAYNfDCF.3j7GPsv5CnBkYz.bAMK', '$2a$10$JoaOwHCxtF1FGR3YbRMn0u', '2013-12-17 23:21:55')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 89ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:21:55 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 4ms (Views: 0.5ms | ActiveRecord: 2.0ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:55', 'woop@tst.com', '2013-12-17 23:21:53', '2013-12-17 23:21:55')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
  [1m[36mSubscription Load (0.2ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.6ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:21:55', 'woop@tst.com', '2013-12-17 23:21:53', '$2a$10$p2DXTlFK3dg..h90AqHkbevZXNHI1jCgwFBGiXhVaivrfo2L3jGCW', '$2a$10$p2DXTlFK3dg..h90AqHkbe', '2013-12-17 23:21:55')[0m
  [1m[35m (0.6ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 75ms (Views: 0.2ms | ActiveRecord: 0.5ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 77ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:55', 'woop@tst.com', '2013-12-17 23:21:53', '2013-12-17 23:21:55')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:21:53 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:21:55', '2014-12-17 23:21:55', '2013-12-17 23:21:55', '2013-12-17 23:21:55')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 1.0ms)
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:21:53 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.5ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:21:55', `updated_at` = '2013-12-17 23:21:55' WHERE `subscriptions`.`id` = 980190963[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 2.1ms)
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:21:55', 'woop@tst.com', '2013-12-17 23:21:53', '2013-12-17 23:21:55')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '785f82e0-6e31-477d-b7c9-b44a50e1bac5', `updated_at` = '2013-12-17 23:21:55' WHERE `users`.`id` = 980190967[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.6ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (72.9ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.7ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (90.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (197.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (90.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.9ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (122.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (161.9ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.2ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.9ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (1.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.9ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (1.1ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:22:14', '2013-12-17 23:22:14', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:22:14', '2013-12-17 23:22:14', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:22:14', '2013-12-17 23:22:14', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:22:14', '2013-12-17 23:22:14', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:22:14', '2013-12-17 23:22:14', 980190962)[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:22:14', '2013-12-17 23:22:14', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:22:14', '2013-12-17 23:22:14', 980190962)
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:22:14', '2013-12-17 23:22:14', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.3ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:22:14 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:22:14', 'tst@tst', '2013-12-17 23:22:14', '$2a$10$Rsl/HrBc3msm0vp59Nazo.Q4g.ZvThNLVO9aNP5DdaAq3aWXjx8B2', '$2a$10$Rsl/HrBc3msm0vp59Nazo.', '2013-12-17 23:22:14')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 90ms (Views: 0.3ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:22:14 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:22:14', 'woop@tst.com', '2013-12-17 23:22:13', '2013-12-17 23:22:14')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
  [1m[36mSubscription Load (0.2ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
Completed 200 OK in 2ms (Views: 0.5ms | ActiveRecord: 0.5ms)
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:22:14', 'woop@tst.com', '2013-12-17 23:22:13', '$2a$10$EApoRdX8ITjL9/4RbvowIOlUKvUym9u95gFapTFjNvif6ACg.xM76', '$2a$10$EApoRdX8ITjL9/4RbvowIO', '2013-12-17 23:22:14')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.8ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 79ms (Views: 0.4ms | ActiveRecord: 0.8ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 75ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:22:14', 'woop@tst.com', '2013-12-17 23:22:13', '2013-12-17 23:22:14')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:22:13 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:22:14', '2014-12-17 23:22:14', '2013-12-17 23:22:14', '2013-12-17 23:22:14')
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.7ms | ActiveRecord: 1.1ms)
  [1m[35mSubscription Load (0.6ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:22:13 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:22:14', `updated_at` = '2013-12-17 23:22:14' WHERE `subscriptions`.`id` = 980190963[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 2.1ms)
  [1m[36mSubscription Load (0.2ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:22:14', 'woop@tst.com', '2013-12-17 23:22:13', '2013-12-17 23:22:14')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = 'a0b53c37-9cea-451f-9e43-3d2bfd07f028', `updated_at` = '2013-12-17 23:22:14' WHERE `users`.`id` = 980190967[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1[0m
  [1m[35m (0.9ms)[0m  ROLLBACK
  [1m[36m (18.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.7ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (98.6ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (168.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (93.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (120.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.8ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (140.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (1.2ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:22:56', '2013-12-17 23:22:56', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:22:56', '2013-12-17 23:22:56', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:22:56', '2013-12-17 23:22:56', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:22:56', '2013-12-17 23:22:56', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:22:56', '2013-12-17 23:22:56', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:22:56', '2013-12-17 23:22:56', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:22:56', '2013-12-17 23:22:56', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:22:56', '2013-12-17 23:22:56', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:22:56 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:22:56', 'tst@tst', '2013-12-17 23:22:56', '$2a$10$smOzbboIrnvkVXSxC1kMkesi/rwbXtQd3j1sqVinJvzt19VGSZ6XS', '$2a$10$smOzbboIrnvkVXSxC1kMke', '2013-12-17 23:22:56')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 89ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:22:56 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:22:56', 'woop@tst.com', '2013-12-17 23:22:55', '2013-12-17 23:22:56')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.4ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:22:57', 'woop@tst.com', '2013-12-17 23:22:55', '$2a$10$qHzRrnk0k0wCSegfIs9zg.mIqHFmjdw1zzuC9rFxwJb8ORxtBy3HW', '$2a$10$qHzRrnk0k0wCSegfIs9zg.', '2013-12-17 23:22:57')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 76ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 78ms (Views: 0.4ms | ActiveRecord: 0.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:22:57', 'woop@tst.com', '2013-12-17 23:22:55', '2013-12-17 23:22:57')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:22:55 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:22:57', '2014-12-17 23:22:57', '2013-12-17 23:22:57', '2013-12-17 23:22:57')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 0.9ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:22:55 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:22:57', `updated_at` = '2013-12-17 23:22:57' WHERE `subscriptions`.`id` = 980190963[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.8ms | ActiveRecord: 1.8ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:22:57', 'woop@tst.com', '2013-12-17 23:22:55', '2013-12-17 23:22:57')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = 'ffc0acfd-a91c-42b2-a407-cd554b92e8b2', `updated_at` = '2013-12-17 23:22:57' WHERE `users`.`id` = 980190967[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (52.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.8ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (69.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (162.1ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.8ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (133.8ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (131.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (136.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:23:24', '2013-12-17 23:23:24', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:23:24', '2013-12-17 23:23:24', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:23:24', '2013-12-17 23:23:24', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:23:24', '2013-12-17 23:23:24', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:23:24', '2013-12-17 23:23:24', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:23:24', '2013-12-17 23:23:24', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:23:24', '2013-12-17 23:23:24', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:23:24', '2013-12-17 23:23:24', 298486374)[0m
  [1m[35m (1.2ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:23:24 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:23:24', 'tst@tst', '2013-12-17 23:23:24', '$2a$10$4A27fj66uUPqiQPSiub8hez1z.eHwWnJtEVI/PcBWQzmrdMIw9.LK', '$2a$10$4A27fj66uUPqiQPSiub8he', '2013-12-17 23:23:24')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 92ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:23:24 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 7ms (Views: 1.4ms | ActiveRecord: 1.7ms)
  [1m[36m (1.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.6ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:23:24', 'woop@tst.com', '2013-12-17 23:23:23', '2013-12-17 23:23:24')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
  [1m[36mSubscription Load (0.2ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
Completed 200 OK in 2ms (Views: 0.4ms | ActiveRecord: 0.5ms)
  [1m[35m (16.1ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:23:24', 'woop@tst.com', '2013-12-17 23:23:23', '$2a$10$m7yaidd5VL69pIbLI6DK7.SgHfabSs7Rb5BTm5z8HLXi1cm8NFwBq', '$2a$10$m7yaidd5VL69pIbLI6DK7.', '2013-12-17 23:23:24')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 75ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 76ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:23:24', 'woop@tst.com', '2013-12-17 23:23:23', '2013-12-17 23:23:24')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:23:23 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:23:24', '2014-12-17 23:23:24', '2013-12-17 23:23:24', '2013-12-17 23:23:24')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.5ms | ActiveRecord: 1.1ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:23:23 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:23:24', `updated_at` = '2013-12-17 23:23:24' WHERE `subscriptions`.`id` = 980190963[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 8ms (Views: 0.9ms | ActiveRecord: 2.3ms)
  [1m[36mSubscription Load (0.8ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
  [1m[35m (1.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:23:24', 'woop@tst.com', '2013-12-17 23:23:23', '2013-12-17 23:23:24')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (1.1ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '38ed1a3d-694b-4bfe-a328-14dfaf2d9ee8', `updated_at` = '2013-12-17 23:23:24' WHERE `users`.`id` = 980190967[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 11ms (Views: 0.2ms | ActiveRecord: 2.7ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (11.9ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (111.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (240.2ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (169.1ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (96.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (142.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (145.0ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:23:46', '2013-12-17 23:23:46', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:23:46', '2013-12-17 23:23:46', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:23:46', '2013-12-17 23:23:46', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:23:46', '2013-12-17 23:23:46', 298486374)[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:23:46', '2013-12-17 23:23:46', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:23:46', '2013-12-17 23:23:46', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:23:46', '2013-12-17 23:23:46', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:23:46', '2013-12-17 23:23:46', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:23:46 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:23:46', 'tst@tst', '2013-12-17 23:23:46', '$2a$10$k0P/vQU2oddKp7dPbGu0..dk1nkKQg9d7Z8qIzxMQFj31NQGgIa3.', '$2a$10$k0P/vQU2oddKp7dPbGu0..', '2013-12-17 23:23:46')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 94ms (Views: 0.3ms | ActiveRecord: 1.8ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:23:46 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.7ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 5ms (Views: 0.2ms | ActiveRecord: 2.5ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[36m (53.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (76.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (158.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (132.4ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (134.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (129.6ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (137.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.7ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.4ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.2ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:25:36', '2013-12-17 23:25:36', 980190962)[0m
  [1m[35mFixture Insert (0.8ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:25:36', '2013-12-17 23:25:36', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:25:36', '2013-12-17 23:25:36', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:25:36', '2013-12-17 23:25:36', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.5ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:25:36', '2013-12-17 23:25:36', 980190962)[0m
  [1m[35mFixture Insert (1.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:25:36', '2013-12-17 23:25:36', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:25:36', '2013-12-17 23:25:36', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:25:36', '2013-12-17 23:25:36', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.9ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:25:36 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:25:37', 'tst@tst', '2013-12-17 23:25:36', '$2a$10$/mt5qRfijdQGzLGyQHbd7.EOZpZ2fgjHoJA/w0J1QgyxPxjDDIQhC', '$2a$10$/mt5qRfijdQGzLGyQHbd7.', '2013-12-17 23:25:37')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 87ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:25:36 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.4ms | ActiveRecord: 1.4ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:25:37', 'woop@tst.com', '2013-12-17 23:25:35', '2013-12-17 23:25:37')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:25:37', 'woop@tst.com', '2013-12-17 23:25:35', '2013-12-17 23:25:37')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:25:37', 'woop@tst.com', '2013-12-17 23:25:35', '2013-12-17 23:25:37')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:25:37', 'woop@tst.com', '2013-12-17 23:25:35', '2013-12-17 23:25:37')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:25:37', 'woop@tst.com', '2013-12-17 23:25:35', '$2a$10$gQo6vIWZ9842a.7vhUbfPOTZV9ebG8W0/bIhpSViYaqOe2buMrjla', '$2a$10$gQo6vIWZ9842a.7vhUbfPO', '2013-12-17 23:25:37')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 77ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 77ms (Views: 0.8ms | ActiveRecord: 1.0ms)
  [1m[35m (1.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:25:37', 'woop@tst.com', '2013-12-17 23:25:35', '2013-12-17 23:25:37')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190969", "start_date"=>"2013-12-17 23:25:35 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190969"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.6ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:25:37', '2014-12-17 23:25:37', '2013-12-17 23:25:37', '2013-12-17 23:25:37')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 12ms (Views: 0.8ms | ActiveRecord: 2.2ms)
  [1m[36mSubscription Load (1.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190969", "start_date"=>"2013-12-17 23:25:35 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190969"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:25:37', `updated_at` = '2013-12-17 23:25:37' WHERE `subscriptions`.`id` = 980190963
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 3.3ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190963 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:25:37', 'woop@tst.com', '2013-12-17 23:25:35', '2013-12-17 23:25:37')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '684c6d51-d5a5-4d45-9b69-98036429decb', `updated_at` = '2013-12-17 23:25:37' WHERE `users`.`id` = 980190970
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190970 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (68.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (101.3ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (198.9ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (146.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (150.0ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (134.3ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (146.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.7ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:26:00', '2013-12-17 23:26:00', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:26:00', '2013-12-17 23:26:00', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:26:00', '2013-12-17 23:26:00', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:26:00', '2013-12-17 23:26:00', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:26:00', '2013-12-17 23:26:00', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:26:00', '2013-12-17 23:26:00', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:26:00', '2013-12-17 23:26:00', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:26:00', '2013-12-17 23:26:00', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:26:00 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (1.1ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:26:01', 'tst@tst', '2013-12-17 23:26:00', '$2a$10$nt9eElhSa4Wp5yPdH/iG/usEuBllUJZnACW3iF1aL820vdVxHhUcK', '$2a$10$nt9eElhSa4Wp5yPdH/iG/u', '2013-12-17 23:26:01')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 96ms (Views: 0.2ms | ActiveRecord: 1.7ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:26:00 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 2.0ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:01', 'woop@tst.com', '2013-12-17 23:25:59', '2013-12-17 23:26:01')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:01', 'woop@tst.com', '2013-12-17 23:25:59', '2013-12-17 23:26:01')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:01', 13.0, '010010101010', '2013-12-17 23:25:59', 1, '2013-12-17 23:26:01', 980190965)
  [1m[36m (0.5ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:01', 'woop@tst.com', '2013-12-17 23:25:59', '2013-12-17 23:26:01')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:01', 13.0, '010010101010', '2013-12-17 23:25:59', 1, '2013-12-17 23:26:01', 980190966)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:01', 'woop@tst.com', '2013-12-17 23:25:59', '2013-12-17 23:26:01')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:01', 13.0, '010010101010', '2013-12-17 23:25:59', 1, '2013-12-17 23:26:01', 980190967)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:26:01', 'woop@tst.com', '2013-12-17 23:25:59', '$2a$10$S2bsQU93knex65Af9Kxp3eEPt4PXypPqA2jQELxYWOnyKWfSns6.e', '$2a$10$S2bsQU93knex65Af9Kxp3e', '2013-12-17 23:26:01')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 77ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 75ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:01', 'woop@tst.com', '2013-12-17 23:25:59', '2013-12-17 23:26:01')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190969", "start_date"=>"2013-12-17 23:25:59 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190969"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:26:01', '2014-12-17 23:26:01', '2013-12-17 23:26:01', '2013-12-17 23:26:01')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.6ms | ActiveRecord: 0.8ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190969", "start_date"=>"2013-12-17 23:25:59 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190969"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:26:01', `updated_at` = '2013-12-17 23:26:01' WHERE `subscriptions`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.5ms | ActiveRecord: 1.8ms)
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:01', 'woop@tst.com', '2013-12-17 23:25:59', '2013-12-17 23:26:01')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '7f5333f8-951f-419d-9163-581028e87cce', `updated_at` = '2013-12-17 23:26:01' WHERE `users`.`id` = 980190970[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[36mUser Load (0.2ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190970 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (76.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (16.1ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (131.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (202.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (164.6ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (228.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (126.5ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (158.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:26:31', '2013-12-17 23:26:31', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:26:31', '2013-12-17 23:26:31', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:26:31', '2013-12-17 23:26:31', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:26:31', '2013-12-17 23:26:31', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:26:31', '2013-12-17 23:26:31', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:26:31', '2013-12-17 23:26:31', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:26:31', '2013-12-17 23:26:31', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:26:31', '2013-12-17 23:26:31', 298486374)[0m
  [1m[35m (0.7ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.4ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:26:31 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:26:31', 'tst@tst', '2013-12-17 23:26:31', '$2a$10$V4DOWZd7xEZjcAwdbnc1wuOaYpTPNVV3xXGaN5y8PNoQherjuGjJm', '$2a$10$V4DOWZd7xEZjcAwdbnc1wu', '2013-12-17 23:26:31')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 109ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:26:31 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.2ms)
  [1m[36m (15.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:31', 'woop@tst.com', '2013-12-17 23:26:30', '2013-12-17 23:26:31')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:31', 'woop@tst.com', '2013-12-17 23:26:30', '2013-12-17 23:26:31')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:31', 13.0, '010010101010', '2013-12-17 23:26:30', 1, '2013-12-17 23:26:31', 980190965)
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:31', 'woop@tst.com', '2013-12-17 23:26:30', '2013-12-17 23:26:31')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:31', 13.0, '010010101010', '2013-12-17 23:26:30', 1, '2013-12-17 23:26:31', 980190966)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:31', 'woop@tst.com', '2013-12-17 23:26:30', '2013-12-17 23:26:31')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:31', 13.0, '010010101010', '2013-12-17 23:26:30', 1, '2013-12-17 23:26:31', 980190967)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35m (1.1ms)[0m  SELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
  [1m[36mSubscription Load (0.5ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
Completed 200 OK in 5ms (Views: 0.8ms | ActiveRecord: 1.6ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:26:32', 'woop@tst.com', '2013-12-17 23:26:30', '$2a$10$vzTZ1G4Z45Bd.sWrU0gZS.ufr5JYaHfQpwzEZF4ia1n3gI.U5sg4e', '$2a$10$vzTZ1G4Z45Bd.sWrU0gZS.', '2013-12-17 23:26:32')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 77ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:32', 'woop@tst.com', '2013-12-17 23:26:30', '2013-12-17 23:26:32')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190969", "start_date"=>"2013-12-17 23:26:30 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190969"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:26:32', '2014-12-17 23:26:32', '2013-12-17 23:26:32', '2013-12-17 23:26:32')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.7ms)
  [1m[35mSubscription Load (0.2ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190969", "start_date"=>"2013-12-17 23:26:30 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190969"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:26:32', `updated_at` = '2013-12-17 23:26:32' WHERE `subscriptions`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 1.5ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.4ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:32', 'woop@tst.com', '2013-12-17 23:26:30', '2013-12-17 23:26:32')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '7de63634-6580-456a-9be7-8fda94974bcb', `updated_at` = '2013-12-17 23:26:32' WHERE `users`.`id` = 980190970[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.2ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190970 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (235.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (190.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (146.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (141.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (121.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (140.1ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:26:50', '2013-12-17 23:26:50', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:26:50', '2013-12-17 23:26:50', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:26:50', '2013-12-17 23:26:50', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:26:50', '2013-12-17 23:26:50', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:26:50', '2013-12-17 23:26:50', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:26:50', '2013-12-17 23:26:50', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:26:50', '2013-12-17 23:26:50', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:26:50', '2013-12-17 23:26:50', 298486374)[0m
  [1m[35m (1.7ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:26:50 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:26:50', 'tst@tst', '2013-12-17 23:26:50', '$2a$10$/vQhW4ZAfgNtvnlW2VQb7OfIMBXXsGbcfeFZHUNUxHFRQgP6YcW12', '$2a$10$/vQhW4ZAfgNtvnlW2VQb7O', '2013-12-17 23:26:50')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 101ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:26:50 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.2ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:50', 'woop@tst.com', '2013-12-17 23:26:49', '2013-12-17 23:26:50')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:50', 'woop@tst.com', '2013-12-17 23:26:49', '2013-12-17 23:26:50')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:50', 13.0, '010010101010', '2013-12-17 23:26:49', 1, '2013-12-17 23:26:50', 980190965)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:50', 'woop@tst.com', '2013-12-17 23:26:49', '2013-12-17 23:26:50')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:50', 13.0, '010010101010', '2013-12-17 23:26:49', 1, '2013-12-17 23:26:50', 980190966)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:50', 'woop@tst.com', '2013-12-17 23:26:49', '2013-12-17 23:26:50')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:26:50', 13.0, '010010101010', '2013-12-17 23:26:49', 1, '2013-12-17 23:26:50', 980190967)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
Completed 200 OK in 3ms (Views: 0.5ms | ActiveRecord: 0.6ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:26:50', 'woop@tst.com', '2013-12-17 23:26:49', '$2a$10$8I1FxnvYcsFcZKVD7UldHuMFdNyqoO/AQ3DyPlDaOpUka2isng1r.', '$2a$10$8I1FxnvYcsFcZKVD7UldHu', '2013-12-17 23:26:50')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 404 Not Found in 75ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:50', 'woop@tst.com', '2013-12-17 23:26:49', '2013-12-17 23:26:50')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190969", "start_date"=>"2013-12-17 23:26:49 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190969"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:26:50', '2014-12-17 23:26:50', '2013-12-17 23:26:50', '2013-12-17 23:26:50')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.7ms | ActiveRecord: 0.9ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190969", "start_date"=>"2013-12-17 23:26:49 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190969"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `subscriptions` SET `end_date` = '2015-12-17 23:26:50', `updated_at` = '2013-12-17 23:26:50' WHERE `subscriptions`.`id` = 980190966[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 1.9ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1[0m
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:26:50', 'woop@tst.com', '2013-12-17 23:26:49', '2013-12-17 23:26:50')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE `users` SET `confirmation_hash` = '8801cbe5-5dcb-4996-b734-4c57eb1a88e6', `updated_at` = '2013-12-17 23:26:50' WHERE `users`.`id` = 980190970[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`id` = 980190970 LIMIT 1[0m
  [1m[35m (1.2ms)[0m  ROLLBACK
  [1m[36m (91.8ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (15.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (79.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (168.6ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (117.9ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (179.7ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (147.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (157.7ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.3ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (16.0ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:27:40', '2013-12-17 23:27:40', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:27:40', '2013-12-17 23:27:40', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:27:40', '2013-12-17 23:27:40', 980190962)
  [1m[36mFixture Insert (0.7ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:27:40', '2013-12-17 23:27:40', 298486374)[0m
  [1m[35mFixture Delete (0.4ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:27:40', '2013-12-17 23:27:40', 980190962)[0m
  [1m[35mFixture Insert (1.3ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:27:40', '2013-12-17 23:27:40', 298486374)
  [1m[36mFixture Delete (0.3ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:27:40', '2013-12-17 23:27:40', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:27:40', '2013-12-17 23:27:40', 298486374)[0m
  [1m[35m (29.7ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:27:40 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:27:40', 'tst@tst', '2013-12-17 23:27:40', '$2a$10$S/HKNhOGZFxMqCiOBGYddeYxytO98tPmQpfhvMcGWokafmF11wYfK', '$2a$10$S/HKNhOGZFxMqCiOBGYdde', '2013-12-17 23:27:40')[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 129ms (Views: 0.3ms | ActiveRecord: 1.2ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:27:40 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.5ms)
  [1m[36m (16.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:27:40', 'woop@tst.com', '2013-12-17 23:27:38', '2013-12-17 23:27:40')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:27:40', 13.0, '010010101010', '2013-12-17 23:27:38', 1, '2013-12-17 23:27:40', 980190964)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:27:40', 13.0, '010010101010', '2013-12-17 23:27:38', 1, '2013-12-17 23:27:40', 980190964)
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:27:40', 13.0, '010010101010', '2013-12-17 23:27:38', 1, '2013-12-17 23:27:40', 980190964)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
Completed 200 OK in 7ms (Views: 2.9ms | ActiveRecord: 1.0ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.1ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:27:40', 'woop@tst.com', '2013-12-17 23:27:38', '$2a$10$zRJ88TkMNKmOAZN01T0pLOoqo1ku5y61rSsVoDVQ4EPjaPksGD/q.', '$2a$10$zRJ88TkMNKmOAZN01T0pLO', '2013-12-17 23:27:40')
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 77ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:27:40', 'woop@tst.com', '2013-12-17 23:27:38', '2013-12-17 23:27:40')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:27:38 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:27:40', '2014-12-17 23:27:40', '2013-12-17 23:27:40', '2013-12-17 23:27:40')[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 6ms (Views: 1.0ms | ActiveRecord: 1.1ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:27:38 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.5ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.8ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:27:40', `updated_at` = '2013-12-17 23:27:40' WHERE `subscriptions`.`id` = 980190966
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 1.1ms | ActiveRecord: 2.8ms)
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.3ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:27:40', 'woop@tst.com', '2013-12-17 23:27:38', '2013-12-17 23:27:40')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '01c262e3-1bcc-45b0-862c-542e35685d79', `updated_at` = '2013-12-17 23:27:40' WHERE `users`.`id` = 980190967
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (48.2ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (96.9ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (213.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (141.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (132.5ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (157.7ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (143.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.9ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:28:14', '2013-12-17 23:28:14', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:28:14', '2013-12-17 23:28:14', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:28:14', '2013-12-17 23:28:14', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:28:14', '2013-12-17 23:28:14', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:28:14', '2013-12-17 23:28:14', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:28:14', '2013-12-17 23:28:14', 298486374)
  [1m[36mFixture Delete (0.6ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:28:14', '2013-12-17 23:28:14', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:28:14', '2013-12-17 23:28:14', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.4ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (1.7ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:28:14 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:28:15', 'tst@tst', '2013-12-17 23:28:14', '$2a$10$FQPPs5A8W6GnglnriFnD4OcbWMg9bbr31LT4k7t2CbeQm5Nf7DHbG', '$2a$10$FQPPs5A8W6GnglnriFnD4O', '2013-12-17 23:28:15')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 87ms (Views: 0.3ms | ActiveRecord: 1.0ms)
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:28:14 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.4ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:28:15', 'woop@tst.com', '2013-12-17 23:28:13', '2013-12-17 23:28:15')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:28:15', 13.0, '010010101010', '2013-12-17 23:28:13', 1, '2013-12-17 23:28:15', 980190964)[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:28:15', 13.0, '010010101010', '2013-12-17 23:28:13', 1, '2013-12-17 23:28:15', 980190964)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:28:15', 13.0, '010010101010', '2013-12-17 23:28:13', 1, '2013-12-17 23:28:15', 980190964)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190964"}
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964[0m
  [1m[35mSubscription Load (0.2ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964
Completed 200 OK in 4ms (Views: 2.3ms | ActiveRecord: 0.6ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:28:15', 'woop@tst.com', '2013-12-17 23:28:13', '$2a$10$kM1y/jJYY3SJHatn4prt6e8yN0HYuMFlSm7FkriZ2.S3MI996JrJK', '$2a$10$kM1y/jJYY3SJHatn4prt6e', '2013-12-17 23:28:15')
  [1m[36m (0.3ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.2ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 77ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:28:15', 'woop@tst.com', '2013-12-17 23:28:13', '2013-12-17 23:28:15')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:28:13 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:28:15', '2014-12-17 23:28:15', '2013-12-17 23:28:15', '2013-12-17 23:28:15')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.7ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190966", "start_date"=>"2013-12-17 23:28:13 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190966"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:28:15', `updated_at` = '2013-12-17 23:28:15' WHERE `subscriptions`.`id` = 980190966
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 6ms (Views: 0.6ms | ActiveRecord: 1.7ms)
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190966 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.4ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:28:15', 'woop@tst.com', '2013-12-17 23:28:13', '2013-12-17 23:28:15')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = '1b2557f8-9e6c-428b-a6fa-d0f56633cbba', `updated_at` = '2013-12-17 23:28:15' WHERE `users`.`id` = 980190967
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190967 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (67.9ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.3ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (96.2ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (173.0ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (120.2ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (120.6ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (130.9ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:30:48', '2013-12-17 23:30:48', 980190962)[0m
  [1m[35mFixture Insert (0.1ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:30:48', '2013-12-17 23:30:48', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:30:48', '2013-12-17 23:30:48', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:30:48', '2013-12-17 23:30:48', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:30:48', '2013-12-17 23:30:48', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:30:48', '2013-12-17 23:30:48', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:30:48', '2013-12-17 23:30:48', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:30:48', '2013-12-17 23:30:48', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:30:48 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:30:48', 'tst@tst', '2013-12-17 23:30:48', '$2a$10$al4HbHn8D2C8rQkrKCu95.3Wc5KzmKe1391aTKVXrTM9lhmrApELO', '$2a$10$al4HbHn8D2C8rQkrKCu95.', '2013-12-17 23:30:48')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 88ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:30:48 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.3ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------
ApiControllerTest: test_get_1_subscription
------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:30:48', 'woop@tst.com', '2013-12-17 23:30:47', '2013-12-17 23:30:48')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:30:48', 13.0, '010010101010', '2013-12-17 23:30:47', 1, '2013-12-17 23:30:48', 980190964)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#get_subscription as HTML
  Parameters: {"user_id"=>"980190964", "subscription_type_id"=>"1"}
Completed 500 Internal Server Error in 1ms
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:30:48', 'woop@tst.com', '2013-12-17 23:30:47', '2013-12-17 23:30:48')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:30:48', 13.0, '010010101010', '2013-12-17 23:30:47', 1, '2013-12-17 23:30:48', 980190965)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:30:48', 13.0, '010010101010', '2013-12-17 23:30:47', 1, '2013-12-17 23:30:48', 980190965)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:30:48', 13.0, '010010101010', '2013-12-17 23:30:47', 1, '2013-12-17 23:30:48', 980190965)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190965"}
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965[0m
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965
Completed 200 OK in 4ms (Views: 2.1ms | ActiveRecord: 0.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:30:49', 'woop@tst.com', '2013-12-17 23:30:47', '$2a$10$VnKiZHKk.uzPC4N8ztoKGO0p7I3IDXQXHFZo9G4.xjgmMjpdSa2cS', '$2a$10$VnKiZHKk.uzPC4N8ztoKGO', '2013-12-17 23:30:49')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.5ms | ActiveRecord: 0.7ms)
  [1m[35m (0.6ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:30:49', 'woop@tst.com', '2013-12-17 23:30:47', '2013-12-17 23:30:49')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:30:47 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:30:49', '2014-12-17 23:30:49', '2013-12-17 23:30:49', '2013-12-17 23:30:49')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 0.7ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:30:47 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:30:49', `updated_at` = '2013-12-17 23:30:49' WHERE `subscriptions`.`id` = 980190967
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 1.6ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:30:49', 'woop@tst.com', '2013-12-17 23:30:47', '2013-12-17 23:30:49')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '6d130ca9-b568-4e85-ac6a-2ecc9c76b207', `updated_at` = '2013-12-17 23:30:49' WHERE `users`.`id` = 980190968
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190968 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[36m (71.5ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.6ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (94.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (168.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (128.0ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (134.4ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (129.6ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.6ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:31:39', '2013-12-17 23:31:39', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:31:39', '2013-12-17 23:31:39', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:31:39', '2013-12-17 23:31:39', 980190962)
  [1m[36mFixture Insert (0.1ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:31:39', '2013-12-17 23:31:39', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:31:39', '2013-12-17 23:31:39', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:31:39', '2013-12-17 23:31:39', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:31:39', '2013-12-17 23:31:39', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:31:39', '2013-12-17 23:31:39', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.2ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:31:39 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:31:40', 'tst@tst', '2013-12-17 23:31:39', '$2a$10$FVJFBLmw0mQM8f.F8.cs7OUHubvnywIrIymyXwe6HPBCeh8t7OXpu', '$2a$10$FVJFBLmw0mQM8f.F8.cs7O', '2013-12-17 23:31:40')[0m
  [1m[35m (0.7ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 96ms (Views: 0.3ms | ActiveRecord: 1.7ms)
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:31:39 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 6ms (Views: 0.3ms | ActiveRecord: 2.1ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------
ApiControllerTest: test_get_1_subscription
------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:31:40', 'woop@tst.com', '2013-12-17 23:31:38', '2013-12-17 23:31:40')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:31:40', 13.0, '010010101010', '2013-12-17 23:31:38', 1, '2013-12-17 23:31:40', 980190964)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#get_subscription as HTML
  Parameters: {"user_id"=>"980190964", "subscription_type_id"=>"1"}
Completed 500 Internal Server Error in 3ms
  [1m[36m (1.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:31:40', 'woop@tst.com', '2013-12-17 23:31:38', '2013-12-17 23:31:40')
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.4ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:31:40', 13.0, '010010101010', '2013-12-17 23:31:38', 1, '2013-12-17 23:31:40', 980190965)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:31:40', 13.0, '010010101010', '2013-12-17 23:31:38', 1, '2013-12-17 23:31:40', 980190965)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:31:40', 13.0, '010010101010', '2013-12-17 23:31:38', 1, '2013-12-17 23:31:40', 980190965)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190965"}
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965[0m
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965
Completed 200 OK in 5ms (Views: 2.7ms | ActiveRecord: 0.7ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:31:40', 'woop@tst.com', '2013-12-17 23:31:38', '$2a$10$WpK3g4CdsSDrPIpy.vftXukS.5PlOR3S8fhusnEnzRknb7/o7QAoS', '$2a$10$WpK3g4CdsSDrPIpy.vftXu', '2013-12-17 23:31:40')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 74ms (Views: 0.2ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 74ms (Views: 0.2ms | ActiveRecord: 0.7ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:31:40', 'woop@tst.com', '2013-12-17 23:31:38', '2013-12-17 23:31:40')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:31:38 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:31:40', '2014-12-17 23:31:40', '2013-12-17 23:31:40', '2013-12-17 23:31:40')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 0.9ms)
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:31:38 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:31:40', `updated_at` = '2013-12-17 23:31:40' WHERE `subscriptions`.`id` = 980190967
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.5ms | ActiveRecord: 1.7ms)
  [1m[35mSubscription Load (0.2ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:31:40', 'woop@tst.com', '2013-12-17 23:31:38', '2013-12-17 23:31:40')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (1.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  UPDATE `users` SET `confirmation_hash` = '4a555bac-f55f-4c36-a41e-60c19ec0ef27', `updated_at` = '2013-12-17 23:31:40' WHERE `users`.`id` = 980190968
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 9ms (Views: 0.4ms | ActiveRecord: 2.6ms)
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190968 LIMIT 1
  [1m[36m (0.9ms)[0m  [1mROLLBACK[0m
  [1m[36m (62.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (163.1ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (174.5ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (121.3ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (122.9ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (132.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (126.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.3ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.3ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.1ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:32:12', '2013-12-17 23:32:12', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:32:12', '2013-12-17 23:32:12', 298486374)
  [1m[36mFixture Delete (0.1ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:32:12', '2013-12-17 23:32:12', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:32:12', '2013-12-17 23:32:12', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:32:12', '2013-12-17 23:32:12', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:32:12', '2013-12-17 23:32:12', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:32:12', '2013-12-17 23:32:12', 980190962)
  [1m[36mFixture Insert (0.6ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:32:12', '2013-12-17 23:32:12', 298486374)[0m
  [1m[35m (0.9ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:32:12 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:32:12', 'tst@tst', '2013-12-17 23:32:12', '$2a$10$lmOY.iMMKTF2Ba7.auZyF.E/UOWSczsKwJIgWggF18TzjBnA/f8/K', '$2a$10$lmOY.iMMKTF2Ba7.auZyF.', '2013-12-17 23:32:12')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 105ms (Views: 0.2ms | ActiveRecord: 1.1ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:32:12 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.2ms | ActiveRecord: 1.5ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------
ApiControllerTest: test_get_1_subscription
------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:12', 'woop@tst.com', '2013-12-17 23:32:11', '2013-12-17 23:32:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:12', 13.0, '010010101010', '2013-12-17 23:32:11', 1, '2013-12-17 23:32:12', 980190964)[0m
  [1m[35m (0.3ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#get_subscription as HTML
  Parameters: {"user_id"=>"980190964", "subscription_type_id"=>"1"}
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964 AND `subscriptions`.`subscription_type_id` = 1[0m
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964 AND `subscriptions`.`subscription_type_id` = 1
Completed 200 OK in 4ms (Views: 1.7ms | ActiveRecord: 0.7ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:12', 'woop@tst.com', '2013-12-17 23:32:11', '2013-12-17 23:32:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:12', 13.0, '010010101010', '2013-12-17 23:32:11', 1, '2013-12-17 23:32:12', 980190965)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:12', 13.0, '010010101010', '2013-12-17 23:32:11', 1, '2013-12-17 23:32:12', 980190965)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:12', 13.0, '010010101010', '2013-12-17 23:32:11', 1, '2013-12-17 23:32:12', 980190965)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190965"}
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965[0m
  [1m[35mSubscription Load (0.2ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965
Completed 200 OK in 3ms (Views: 1.6ms | ActiveRecord: 0.5ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:32:12', 'woop@tst.com', '2013-12-17 23:32:11', '$2a$10$934/.h2wU/vjVI2CijvsNuIY0GGUF3c./giJjoLQ9XJt.O8UBajFm', '$2a$10$934/.h2wU/vjVI2CijvsNu', '2013-12-17 23:32:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.5ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.2ms | ActiveRecord: 0.5ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.5ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:12', 'woop@tst.com', '2013-12-17 23:32:11', '2013-12-17 23:32:12')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:32:11 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:32:12', '2014-12-17 23:32:12', '2013-12-17 23:32:12', '2013-12-17 23:32:12')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 4ms (Views: 0.4ms | ActiveRecord: 0.8ms)
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:32:11 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:32:12', `updated_at` = '2013-12-17 23:32:12' WHERE `subscriptions`.`id` = 980190967
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 1.7ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1
  [1m[36m (2.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:12', 'woop@tst.com', '2013-12-17 23:32:11', '2013-12-17 23:32:12')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE `users` SET `confirmation_hash` = 'd5760d83-56a7-415b-9e17-ea01f797c437', `updated_at` = '2013-12-17 23:32:12' WHERE `users`.`id` = 980190968
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.2ms | ActiveRecord: 1.0ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190968 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (66.1ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.5ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (67.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (121.4ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (123.5ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (118.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (119.1ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (138.4ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.7ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.5ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.5ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.9ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.6ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.2ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:32:29', '2013-12-17 23:32:29', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:32:29', '2013-12-17 23:32:29', 298486374)
  [1m[36mFixture Delete (0.4ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.4ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:32:29', '2013-12-17 23:32:29', 980190962)
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:32:29', '2013-12-17 23:32:29', 298486374)[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:32:29', '2013-12-17 23:32:29', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:32:29', '2013-12-17 23:32:29', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.3ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:32:29', '2013-12-17 23:32:29', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:32:29', '2013-12-17 23:32:29', 298486374)[0m
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:32:29 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:32:29', 'tst@tst', '2013-12-17 23:32:29', '$2a$10$1bZF.Vsa448kCJJBqlTjgeriez0xQxmU70NTkFdzuv7obG2MwT3WS', '$2a$10$1bZF.Vsa448kCJJBqlTjge', '2013-12-17 23:32:29')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 86ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:32:29 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 3ms (Views: 0.3ms | ActiveRecord: 1.2ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------
ApiControllerTest: test_get_1_subscription
------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:29', 'woop@tst.com', '2013-12-17 23:32:28', '2013-12-17 23:32:29')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:29', 13.0, '010010101010', '2013-12-17 23:32:28', 1, '2013-12-17 23:32:29', 980190964)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#get_subscription as HTML
  Parameters: {"user_id"=>"980190964", "subscription_type_id"=>"1"}
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964 AND `subscriptions`.`subscription_type_id` = 1[0m
  [1m[35mSubscription Load (0.2ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964 AND `subscriptions`.`subscription_type_id` = 1
Completed 200 OK in 3ms (Views: 1.7ms | ActiveRecord: 0.5ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:29', 'woop@tst.com', '2013-12-17 23:32:28', '2013-12-17 23:32:29')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:29', 13.0, '010010101010', '2013-12-17 23:32:28', 1, '2013-12-17 23:32:29', 980190965)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:29', 13.0, '010010101010', '2013-12-17 23:32:28', 1, '2013-12-17 23:32:29', 980190965)
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:29', 13.0, '010010101010', '2013-12-17 23:32:28', 1, '2013-12-17 23:32:29', 980190965)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190965"}
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965[0m
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965
Completed 200 OK in 4ms (Views: 2.3ms | ActiveRecord: 0.6ms)
  [1m[36m (0.6ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:32:29', 'woop@tst.com', '2013-12-17 23:32:28', '$2a$10$B1Q5SdHmlmrYnBLxw8bKNu7R8xR.SJYvGmPKXqlKqoZkntboG15nq', '$2a$10$B1Q5SdHmlmrYnBLxw8bKNu', '2013-12-17 23:32:29')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 76ms (Views: 0.3ms | ActiveRecord: 0.3ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.8ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.3ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:29', 'woop@tst.com', '2013-12-17 23:32:28', '2013-12-17 23:32:29')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:32:28 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.4ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:32:29', '2014-12-17 23:32:29', '2013-12-17 23:32:29', '2013-12-17 23:32:29')[0m
  [1m[35m (0.4ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 8ms (Views: 0.7ms | ActiveRecord: 1.7ms)
  [1m[36mSubscription Load (0.6ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:32:28 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:32:29', `updated_at` = '2013-12-17 23:32:29' WHERE `subscriptions`.`id` = 980190967
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 5ms (Views: 0.5ms | ActiveRecord: 2.7ms)
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:29', 'woop@tst.com', '2013-12-17 23:32:28', '2013-12-17 23:32:29')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = '9244b45d-3de2-4dd0-8c9c-d0c4eaaf934b', `updated_at` = '2013-12-17 23:32:29' WHERE `users`.`id` = 980190968
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 4ms (Views: 0.2ms | ActiveRecord: 0.8ms)
  [1m[35mUser Load (0.2ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190968 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[36m (11.4ms)[0m  [1mDROP DATABASE IF EXISTS `subscription_api_test`[0m
  [1m[35m (0.4ms)[0m  CREATE DATABASE `subscription_api_test` DEFAULT CHARACTER SET `utf8` COLLATE `utf8_unicode_ci`
  [1m[36m (117.8ms)[0m  [1mCREATE TABLE `apps` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (184.7ms)[0m  CREATE TABLE `subscription_types` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `name` text, `duration` int(11), `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB
  [1m[36m (140.4ms)[0m  [1mCREATE TABLE `subscriptions` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `subscription_type_id` int(11), `user_id` int(11), `start_date` datetime, `end_date` datetime, `receipt` text, `price` float, `created_at` datetime, `updated_at` datetime) ENGINE=InnoDB[0m
  [1m[35m (144.2ms)[0m  CREATE TABLE `users` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `app_id` int(11), `email` text, `password_hash` text, `password_salt` text, `last_login` datetime, `created_at` datetime, `updated_at` datetime, `confirmation_hash` text, `activate` tinyint(1)) ENGINE=InnoDB
  [1m[36m (132.0ms)[0m  [1mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [1m[35m (136.8ms)[0m  CREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`) 
  [1m[36m (0.2ms)[0m  [1mSELECT version FROM `schema_migrations`[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131216205329')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214194838')[0m
  [1m[35m (0.3ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214194947')
  [1m[36m (0.4ms)[0m  [1mINSERT INTO `schema_migrations` (version) VALUES ('20131214195352')[0m
  [1m[35m (0.4ms)[0m  INSERT INTO `schema_migrations` (version) VALUES ('20131214195840')
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT `schema_migrations`.* FROM `schema_migrations`[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT `schema_migrations`.* FROM `schema_migrations`
  [1m[36m (0.2ms)[0m  [1mSELECT @@FOREIGN_KEY_CHECKS[0m
  [1m[35m (0.1ms)[0m  SET FOREIGN_KEY_CHECKS = 0
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mFixture Delete (0.2ms)[0m  DELETE FROM `apps`
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:32:42', '2013-12-17 23:32:42', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `apps` (`name`, `created_at`, `updated_at`, `id`) VALUES ('MyString', '2013-12-17 23:32:42', '2013-12-17 23:32:42', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `subscription_types`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:32:42', '2013-12-17 23:32:42', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `subscription_types` (`app_id`, `name`, `duration`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 1, '2013-12-17 23:32:42', '2013-12-17 23:32:42', 298486374)[0m
  [1m[35mFixture Delete (0.3ms)[0m  DELETE FROM `subscriptions`
  [1m[36mFixture Insert (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:32:42', '2013-12-17 23:32:42', 980190962)[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `subscriptions` (`subscription_type_id`, `user_id`, `start_date`, `end_date`, `receipt`, `price`, `created_at`, `updated_at`, `id`) VALUES (1, 1, '2013-12-14 13:58:40', '2013-12-14 13:58:40', 'MyText', 1.5, '2013-12-17 23:32:42', '2013-12-17 23:32:42', 298486374)
  [1m[36mFixture Delete (0.2ms)[0m  [1mDELETE FROM `users`[0m
  [1m[35mFixture Insert (0.2ms)[0m  INSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:32:42', '2013-12-17 23:32:42', 980190962)
  [1m[36mFixture Insert (0.2ms)[0m  [1mINSERT INTO `users` (`app_id`, `email`, `password_hash`, `password_salt`, `last_login`, `created_at`, `updated_at`, `id`) VALUES (1, 'MyText', 'MyText', 'MyText', '2013-12-14 13:53:52', '2013-12-17 23:32:42', '2013-12-17 23:32:42', 298486374)[0m
  [1m[35m (0.6ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mSET FOREIGN_KEY_CHECKS = 1[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------
ApiControllerTest: test_create_user
-----------------------------------
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:32:42 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[36mUser Load (0.4ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES ('2013-12-17 23:32:42', 'tst@tst', '2013-12-17 23:32:42', '$2a$10$vO4PB4fGwjrrJYXPMngecuaK0yNeyffsSLQ4qmz6HyWuiNHfR/egi', '$2a$10$vO4PB4fGwjrrJYXPMngecu', '2013-12-17 23:32:42')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 90ms (Views: 0.2ms | ActiveRecord: 0.9ms)
  [1m[36mUser Load (0.3ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1[0m
Processing by ApiController#register_user as HTML
  Parameters: {"user"=>{"email"=>"tst@tst", "app_id"=>"1", "last_login"=>"2013-12-17 17:32:42 -0600", "password"=>"[FILTERED]"}}
Unpermitted parameters: app_id
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'tst@tst' LIMIT 1
Completed 500 Internal Server Error in 2ms (Views: 0.2ms | ActiveRecord: 1.2ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------
ApiControllerTest: test_get_1_subscription
------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:42', 'woop@tst.com', '2013-12-17 23:32:41', '2013-12-17 23:32:42')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:42', 13.0, '010010101010', '2013-12-17 23:32:41', 1, '2013-12-17 23:32:42', 980190964)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#get_subscription as HTML
  Parameters: {"user_id"=>"980190964", "subscription_type_id"=>"1"}
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964 AND `subscriptions`.`subscription_type_id` = 1[0m
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190964 AND `subscriptions`.`subscription_type_id` = 1
Completed 200 OK in 4ms (Views: 2.0ms | ActiveRecord: 0.7ms)
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
ApiControllerTest: test_get_all_subscriptions
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:42', 'woop@tst.com', '2013-12-17 23:32:41', '2013-12-17 23:32:42')
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:42', 13.0, '010010101010', '2013-12-17 23:32:41', 1, '2013-12-17 23:32:42', 980190965)[0m
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.5ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:42', 13.0, '010010101010', '2013-12-17 23:32:41', 1, '2013-12-17 23:32:42', 980190965)
  [1m[36m (0.4ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `price`, `receipt`, `start_date`, `subscription_type_id`, `updated_at`, `user_id`) VALUES ('2013-12-17 23:32:42', 13.0, '010010101010', '2013-12-17 23:32:41', 1, '2013-12-17 23:32:42', 980190965)[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#all_subscriptions as HTML
  Parameters: {"user_id"=>"980190965"}
  [1m[36m (0.7ms)[0m  [1mSELECT COUNT(*) FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965[0m
  [1m[35mSubscription Load (0.3ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` = 980190965
Completed 200 OK in 5ms (Views: 1.7ms | ActiveRecord: 1.0ms)
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------
ApiControllerTest: test_login_working
-------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `password_hash`, `password_salt`, `updated_at`) VALUES (1, '2013-12-17 23:32:42', 'woop@tst.com', '2013-12-17 23:32:41', '$2a$10$k0XjaxoptDx6UH2Od.xYgOlfM1h8BurajLcp092T4.aW1/wOwkWma', '$2a$10$k0XjaxoptDx6UH2Od.xYgO', '2013-12-17 23:32:42')
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[35mUser Load (0.4ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1
Completed 200 OK in 75ms (Views: 0.3ms | ActiveRecord: 0.4ms)
Processing by ApiController#login as HTML
  Parameters: {"email"=>"woop@tst.com", "password"=>"[FILTERED]"}
  [1m[36mUser Load (0.5ms)[0m  [1mSELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' LIMIT 1[0m
Completed 404 Not Found in 76ms (Views: 0.3ms | ActiveRecord: 0.9ms)
  [1m[35m (0.7ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------
ApiControllerTest: test_new_subscription
----------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:42', 'woop@tst.com', '2013-12-17 23:32:41', '2013-12-17 23:32:42')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:32:41 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[36mSubscription Load (0.3ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO `subscriptions` (`created_at`, `end_date`, `start_date`, `updated_at`) VALUES ('2013-12-17 23:32:42', '2014-12-17 23:32:42', '2013-12-17 23:32:42', '2013-12-17 23:32:42')[0m
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Completed 200 OK in 3ms (Views: 0.4ms | ActiveRecord: 0.7ms)
  [1m[36mSubscription Load (0.2ms)[0m  [1mSELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1[0m
Processing by ApiController#add_subscription as HTML
  Parameters: {"subscription"=>{"id"=>nil, "subscription_type_id"=>"1", "user_id"=>"980190967", "start_date"=>"2013-12-17 23:32:41 UTC", "end_date"=>nil, "receipt"=>"010010101010", "price"=>"13.0", "created_at"=>nil, "updated_at"=>nil}, "user_id"=>"980190967"}
Unpermitted parameters: subscription, user_id
  [1m[35mSubscription Load (1.6ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`user_id` IS NULL AND `subscriptions`.`subscription_type_id` IS NULL LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.7ms)[0m  UPDATE `subscriptions` SET `end_date` = '2015-12-17 23:32:42', `updated_at` = '2013-12-17 23:32:42' WHERE `subscriptions`.`id` = 980190967
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 12ms (Views: 0.9ms | ActiveRecord: 3.7ms)
  [1m[35mSubscription Load (0.4ms)[0m  SELECT `subscriptions`.* FROM `subscriptions` WHERE `subscriptions`.`id` = 980190967 LIMIT 1
  [1m[36m (0.5ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.3ms)[0m  BEGIN
--------------------------------------
ApiControllerTest: test_password_reset
--------------------------------------
  [1m[36m (0.4ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO `users` (`app_id`, `created_at`, `email`, `last_login`, `updated_at`) VALUES (1, '2013-12-17 23:32:42', 'woop@tst.com', '2013-12-17 23:32:41', '2013-12-17 23:32:42')
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by ApiController#password_reset as HTML
  Parameters: {"email"=>"woop@tst.com", "app_id"=>"1"}
  [1m[35mUser Load (0.6ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`email` = 'woop@tst.com' AND `users`.`app_id` = 1 LIMIT 1
  [1m[36m (0.6ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE `users` SET `confirmation_hash` = 'db79187a-2193-44f8-8f50-4b57ca51d110', `updated_at` = '2013-12-17 23:32:42' WHERE `users`.`id` = 980190968
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 10ms (Views: 0.2ms | ActiveRecord: 1.7ms)
  [1m[35mUser Load (0.3ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 980190968 LIMIT 1
  [1m[36m (0.4ms)[0m  [1mROLLBACK[0m
